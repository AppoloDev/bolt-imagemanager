function F(){}const cn=n=>n;function T(n,e){for(const r in e)n[r]=e[r];return n}function Bt(n){return n()}function mt(){return Object.create(null)}function G(n){n.forEach(Bt)}function x(n){return typeof n=="function"}function A(n,e){return n!=n?e==e:n!==e||n&&typeof n=="object"||typeof n=="function"}let Me;function Se(n,e){return Me||(Me=document.createElement("a")),Me.href=e,n===Me.href}function fn(n){return Object.keys(n).length===0}function Pt(n,...e){if(n==null)return F;const r=n.subscribe(...e);return r.unsubscribe?()=>r.unsubscribe():r}function dn(n){let e;return Pt(n,r=>e=r)(),e}function J(n,e,r){n.$$.on_destroy.push(Pt(e,r))}function Be(n,e,r,t){if(n){const l=Rt(n,e,r,t);return n[0](l)}}function Rt(n,e,r,t){return n[1]&&t?T(r.ctx.slice(),n[1](t(e))):r.ctx}function Pe(n,e,r,t){if(n[2]&&t){const l=n[2](t(r));if(e.dirty===void 0)return l;if(typeof l=="object"){const s=[],i=Math.max(e.dirty.length,l.length);for(let a=0;a<i;a+=1)s[a]=e.dirty[a]|l[a];return s}return e.dirty|l}return e.dirty}function Re(n,e,r,t,l,s){if(l){const i=Rt(e,r,t,s);n.p(i,l)}}function Ve(n){if(n.ctx.length>32){const e=[],r=n.ctx.length/32;for(let t=0;t<r;t++)e[t]=-1;return e}return-1}function ve(n){const e={};for(const r in n)r[0]!=="$"&&(e[r]=n[r]);return e}function Ae(n){return n??""}function Vt(n,e,r){return n.set(r),e}function ee(n){return n&&x(n.destroy)?n.destroy:F}function pt(n){const e=typeof n=="string"&&n.match(/^\s*(-?[\d.]+)([^\s]*)\s*$/);return e?[parseFloat(e[1]),e[2]||"px"]:[n,"px"]}const Zt=typeof window<"u";let hn=Zt?()=>window.performance.now():()=>Date.now(),rt=Zt?n=>requestAnimationFrame(n):F;const me=new Set;function Kt(n){me.forEach(e=>{e.c(n)||(me.delete(e),e.f())}),me.size!==0&&rt(Kt)}function mn(n){let e;return me.size===0&&rt(Kt),{promise:new Promise(r=>{me.add(e={c:n,f:r})}),abort(){me.delete(e)}}}function d(n,e){n.appendChild(e)}function Ut(n){if(!n)return document;const e=n.getRootNode?n.getRootNode():n.ownerDocument;return e&&e.host?e:n.ownerDocument}function pn(n){const e=y("style");return gn(Ut(n),e),e.sheet}function gn(n,e){return d(n.head||n,e),e.sheet}function C(n,e,r){n.insertBefore(e,r||null)}function w(n){n.parentNode&&n.parentNode.removeChild(n)}function De(n,e){for(let r=0;r<n.length;r+=1)n[r]&&n[r].d(e)}function y(n){return document.createElement(n)}function j(n){return document.createElementNS("http://www.w3.org/2000/svg",n)}function te(n){return document.createTextNode(n)}function O(){return te(" ")}function ue(){return te("")}function V(n,e,r,t){return n.addEventListener(e,r,t),()=>n.removeEventListener(e,r,t)}function ae(n){return function(e){return e.preventDefault(),n.call(this,e)}}function lt(n){return function(e){return e.stopPropagation(),n.call(this,e)}}function c(n,e,r){r==null?n.removeAttribute(e):n.getAttribute(e)!==r&&n.setAttribute(e,r)}const _n=["width","height"];function gt(n,e){const r=Object.getOwnPropertyDescriptors(n.__proto__);for(const t in e)e[t]==null?n.removeAttribute(t):t==="style"?n.style.cssText=e[t]:t==="__value"?n.value=n[t]=e[t]:r[t]&&r[t].set&&_n.indexOf(t)===-1?n[t]=e[t]:c(n,t,e[t])}function _t(n,e){for(const r in e)c(n,r,e[r])}function vn(n){return Array.from(n.childNodes)}function be(n,e){e=""+e,n.data!==e&&(n.data=e)}function vt(n,e){n.value=e??""}function W(n,e,r){n.classList[r?"add":"remove"](e)}function Ht(n,e,{bubbles:r=!1,cancelable:t=!1}={}){const l=document.createEvent("CustomEvent");return l.initCustomEvent(n,r,t,e),l}const je=new Map;let Qe=0;function bn(n){let e=5381,r=n.length;for(;r--;)e=(e<<5)-e^n.charCodeAt(r);return e>>>0}function yn(n,e){const r={stylesheet:pn(e),rules:{}};return je.set(n,r),r}function bt(n,e,r,t,l,s,i,a=0){const o=16.666/t;let u=`{
`;for(let p=0;p<=1;p+=o){const $=e+(r-e)*s(p);u+=p*100+`%{${i($,1-$)}}
`}const f=u+`100% {${i(r,1-r)}}
}`,h=`__svelte_${bn(f)}_${a}`,v=Ut(n),{stylesheet:_,rules:k}=je.get(v)||yn(v,n);k[h]||(k[h]=!0,_.insertRule(`@keyframes ${h} ${f}`,_.cssRules.length));const b=n.style.animation||"";return n.style.animation=`${b?`${b}, `:""}${h} ${t}ms linear ${l}ms 1 both`,Qe+=1,h}function $n(n,e){const r=(n.style.animation||"").split(", "),t=r.filter(e?s=>s.indexOf(e)<0:s=>s.indexOf("__svelte")===-1),l=r.length-t.length;l&&(n.style.animation=t.join(", "),Qe-=l,Qe||wn())}function wn(){rt(()=>{Qe||(je.forEach(n=>{const{ownerNode:e}=n.stylesheet;e&&w(e)}),je.clear())})}let ze;function Ce(n){ze=n}function it(){if(!ze)throw new Error("Function called outside component initialization");return ze}function kn(){const n=it();return(e,r,{cancelable:t=!1}={})=>{const l=n.$$.callbacks[e];if(l){const s=Ht(e,r,{cancelable:t});return l.slice().forEach(i=>{i.call(n,s)}),!s.defaultPrevented}return!0}}function Gt(n,e){return it().$$.context.set(n,e),e}function Jt(n){return it().$$.context.get(n)}const he=[],Ne=[];let pe=[];const yt=[],Cn=Promise.resolve();let Te=!1;function zn(){Te||(Te=!0,Cn.then(Wt))}function oe(n){pe.push(n)}const Ge=new Set;let ce=0;function Wt(){if(ce!==0)return;const n=ze;do{try{for(;ce<he.length;){const e=he[ce];ce++,Ce(e),Ln(e.$$)}}catch(e){throw he.length=0,ce=0,e}for(Ce(null),he.length=0,ce=0;Ne.length;)Ne.pop()();for(let e=0;e<pe.length;e+=1){const r=pe[e];Ge.has(r)||(Ge.add(r),r())}pe.length=0}while(he.length);for(;yt.length;)yt.pop()();Te=!1,Ge.clear(),Ce(n)}function Ln(n){if(n.fragment!==null){n.update(),G(n.before_update);const e=n.dirty;n.dirty=[-1],n.fragment&&n.fragment.p(n.ctx,e),n.after_update.forEach(oe)}}function En(n){const e=[],r=[];pe.forEach(t=>n.indexOf(t)===-1?e.push(t):r.push(t)),r.forEach(t=>t()),pe=e}let ke;function Fn(){return ke||(ke=Promise.resolve(),ke.then(()=>{ke=null})),ke}function Je(n,e,r){n.dispatchEvent(Ht(`${e?"intro":"outro"}${r}`))}const Oe=new Set;let Y;function Z(){Y={r:0,c:[],p:Y}}function K(){Y.r||G(Y.c),Y=Y.p}function m(n,e){n&&n.i&&(Oe.delete(n),n.i(e))}function g(n,e,r,t){if(n&&n.o){if(Oe.has(n))return;Oe.add(n),Y.c.push(()=>{Oe.delete(n),t&&(r&&n.d(1),t())}),n.o(e)}else t&&t()}const Dn={duration:0};function ie(n,e,r,t){const l={direction:"both"};let s=e(n,r,l),i=t?0:1,a=null,o=null,u=null;function f(){u&&$n(n,u)}function h(_,k){const b=_.b-i;return k*=Math.abs(b),{a:i,b:_.b,d:b,duration:k,start:_.start,end:_.start+k,group:_.group}}function v(_){const{delay:k=0,duration:b=300,easing:p=cn,tick:$=F,css:B}=s||Dn,z={start:hn()+k,b:_};_||(z.group=Y,Y.r+=1),a||o?o=z:(B&&(f(),u=bt(n,i,_,b,k,p,B)),_&&$(0,1),a=h(z,b),oe(()=>Je(n,_,"start")),mn(L=>{if(o&&L>o.start&&(a=h(o,b),o=null,Je(n,a.b,"start"),B&&(f(),u=bt(n,i,a.b,a.duration,0,p,s.css))),a){if(L>=a.end)$(i=a.b,1-i),Je(n,a.b,"end"),o||(a.b?f():--a.group.r||G(a.group.c)),a=null;else if(L>=a.start){const E=L-a.start;i=a.a+a.d*p(E/a.duration),$(i,1-i)}}return!!(a||o)}))}return{run(_){x(s)?Fn().then(()=>{s=s(l),v(_)}):v(_)},end(){f(),a=o=null}}}function Yt(n,e){const r={},t={},l={$$scope:1};let s=n.length;for(;s--;){const i=n[s],a=e[s];if(a){for(const o in i)o in a||(t[o]=1);for(const o in a)l[o]||(r[o]=a[o],l[o]=1);n[s]=a}else for(const o in i)l[o]=1}for(const i in t)i in r||(r[i]=void 0);return r}function q(n){n&&n.c()}function D(n,e,r,t){const{fragment:l,after_update:s}=n.$$;l&&l.m(e,r),t||oe(()=>{const i=n.$$.on_mount.map(Bt).filter(x);n.$$.on_destroy?n.$$.on_destroy.push(...i):G(i),n.$$.on_mount=[]}),s.forEach(oe)}function M(n,e){const r=n.$$;r.fragment!==null&&(En(r.after_update),G(r.on_destroy),r.fragment&&r.fragment.d(e),r.on_destroy=r.fragment=null,r.ctx=[])}function Mn(n,e){n.$$.dirty[0]===-1&&(he.push(n),zn(),n.$$.dirty.fill(0)),n.$$.dirty[e/31|0]|=1<<e%31}function Q(n,e,r,t,l,s,i,a=[-1]){const o=ze;Ce(n);const u=n.$$={fragment:null,ctx:[],props:s,update:F,not_equal:l,bound:mt(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(o?o.$$.context:[])),callbacks:mt(),dirty:a,skip_bound:!1,root:e.target||o.$$.root};i&&i(u.root);let f=!1;if(u.ctx=r?r(n,e.props||{},(h,v,..._)=>{const k=_.length?_[0]:v;return u.ctx&&l(u.ctx[h],u.ctx[h]=k)&&(!u.skip_bound&&u.bound[h]&&u.bound[h](k),f&&Mn(n,h)),v}):[],u.update(),f=!0,G(u.before_update),u.fragment=t?t(u.ctx):!1,e.target){if(e.hydrate){const h=vn(e.target);u.fragment&&u.fragment.l(h),h.forEach(w)}else u.fragment&&u.fragment.c();e.intro&&m(n.$$.fragment),D(n,e.target,e.anchor,e.customElement),Wt()}Ce(o)}class N{$destroy(){M(this,1),this.$destroy=F}$on(e,r){if(!x(r))return F;const t=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return t.push(r),()=>{const l=t.indexOf(r);l!==-1&&t.splice(l,1)}}$set(e){this.$$set&&!fn(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}function On(n){const e=n-1;return e*e*e+1}function se(n,{delay:e=0,duration:r=400,easing:t=On,x:l=0,y:s=0,opacity:i=0}={}){const a=getComputedStyle(n),o=+a.opacity,u=a.transform==="none"?"":a.transform,f=o*(1-i),[h,v]=pt(l),[_,k]=pt(s);return{delay:e,duration:r,easing:t,css:(b,p)=>`
			transform: ${u} translate(${(1-b)*h}${v}, ${(1-b)*_}${k});
			opacity: ${o-f*p}`}}const fe=[];function ye(n,e=F){let r;const t=new Set;function l(a){if(A(n,a)&&(n=a,r)){const o=!fe.length;for(const u of t)u[1](),fe.push(u,n);if(o){for(let u=0;u<fe.length;u+=2)fe[u][0](fe[u+1]);fe.length=0}}}function s(a){l(a(n))}function i(a,o=F){const u=[a,o];return t.add(u),t.size===1&&(r=e(l)||F),a(n),()=>{t.delete(u),t.size===0&&r&&(r(),r=null)}}return{set:l,update:s,subscribe:i}}var qn=Object.defineProperty,Sn=Object.defineProperties,An=Object.getOwnPropertyDescriptors,$t=Object.getOwnPropertySymbols,jn=Object.prototype.hasOwnProperty,Qn=Object.prototype.propertyIsEnumerable,xe=(n,e,r)=>e in n?qn(n,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[e]=r,ne=(n,e)=>{for(var r in e||(e={}))jn.call(e,r)&&xe(n,r,e[r]);if($t)for(var r of $t(e))Qn.call(e,r)&&xe(n,r,e[r]);return n},Le=(n,e)=>Sn(n,An(e)),X=(n,e,r)=>(xe(n,typeof e!="symbol"?e+"":e,r),r);function Xt(n,e="outclick"){const r=t=>{n.contains(t.target)||n.dispatchEvent(new CustomEvent(e,{bubbles:e!=="outclick"}))};return document.addEventListener("click",r,!0),{destroy(){document.removeEventListener("click",r,!0)}}}function Nn(n){return typeof n=="object"&&typeof n.then=="function"}class In{constructor(e,r){X(this,"store"),X(this,"getState",()=>dn(this.store)),X(this,"setData",l=>{this.store.update(s=>Le(ne({},s),{isLoading:!1,isSuccess:!0,data:typeof l=="function"?l(s.data):l}))}),X(this,"getData",()=>this.getState().data);const t=()=>{if(this.getData())return;const l=e();Nn(l)?l.then(this.setData).catch(s=>{var i;(i=r.onError)==null||i.call(r),this.store.update(a=>Le(ne({},a),{isLoading:!1,isSuccess:!1}))}):this.setData(l)};this.store=ye({isSuccess:!1,isLoading:!1,data:void 0,refetch:t}),r.enabled!==!1&&t()}}class Bn{constructor(){X(this,"queries",new Map)}getQuery(e,r,t={}){return this.queries.has(e)||this.queries.set(e,new In(r,t)),this.queries.get(e)}setQueryData(e,r){const t=this.queries.get(e);t&&t.setData(r)}getQueryData(e){var r;return(r=this.queries.get(e))==null?void 0:r.getData()}getQueryState(e){const r=this.queries.get(e);return r?r.getState():{data:void 0,isLoading:!1,isSuccess:!1,refetch:()=>{}}}}function et(n,e,r={}){return{subscribe:$e().getQuery(n,e,r).store.subscribe}}function Tt(n,e={}){const r=l=>(t.update(s=>Le(ne({},s),{isLoading:!0})),n(l).then(s=>{var i;return(i=e.onSuccess)==null||i.call(e,s),s}).catch(s=>{var i;throw(i=e.onError)==null||i.call(e,s),s}).finally(()=>{t.update(s=>Le(ne({},s),{isLoading:!1}))})),t=ye({isLoading:!1,mutate:l=>{r(l).catch(()=>null)},mutateAsync:r});return{subscribe:t.subscribe}}function Pn(n){let e;const r=n[2].default,t=Be(r,n,n[1],null);return{c(){t&&t.c()},m(l,s){t&&t.m(l,s),e=!0},p(l,[s]){t&&t.p&&(!e||s&2)&&Re(t,r,l,l[1],e?Pe(r,l[1],s,null):Ve(l[1]),null)},i(l){e||(m(t,l),e=!0)},o(l){g(t,l),e=!1},d(l){t&&t.d(l)}}}function Rn(n,e,r){let{$$slots:t={},$$scope:l}=e,{client:s}=e;return Gt(xt,s),n.$$set=i=>{"client"in i&&r(0,s=i.client),"$$scope"in i&&r(1,l=i.$$scope)},[s,l,t]}class Vn extends N{constructor(e){super(),Q(this,e,Rn,Pn,A,{client:0})}}const xt=Symbol("queryClient");function $e(){return Jt(xt)}function Zn(n){let e,r,t;return{c(){e=y("div"),c(e,"class",r=Ae(`loader ${n[1].class}`)+" svelte-1cyki07"),c(e,"style",t=`--size:${n[0]}px`)},m(l,s){C(l,e,s)},p(l,[s]){s&2&&r!==(r=Ae(`loader ${l[1].class}`)+" svelte-1cyki07")&&c(e,"class",r),s&1&&t!==(t=`--size:${l[0]}px`)&&c(e,"style",t)},i:F,o:F,d(l){l&&w(e)}}}function Kn(n,e,r){let{size:t=20}=e;return n.$$set=l=>{r(1,e=T(T({},e),ve(l))),"size"in l&&r(0,t=l.size)},e=ve(e),[t,e]}class Ze extends N{constructor(e){super(),Q(this,e,Kn,Zn,A,{size:0})}}function Un(n){let e,r,t,l=[{width:"23"},{height:"23"},{fill:"none"},{xmlns:"http://www.w3.org/2000/svg"},n[0]],s={};for(let i=0;i<l.length;i+=1)s=T(s,l[i]);return{c(){e=j("svg"),r=j("path"),t=j("path"),c(r,"d","M22.7 10.578c-.289-.29-.72-.578-1.152-.578H5.715c-.575 0-1.151.289-1.295.867L.102 20.977C-.186 21.845.102 23 1.397 23H17.23c.575 0 1.151-.289 1.295-.867l4.318-10.11c.288-.434.144-1.012-.144-1.445z"),c(r,"fill","currentColor"),c(t,"d","M1.754 9.814c.73-1.587 2.338-2.598 4.092-2.598H19V4.33c0-.866-.585-1.443-1.462-1.443H9.354L6.869.433C6.577.144 6.285 0 5.846 0H1.462C.585 0 0 .577 0 1.443V14l1.754-4.186z"),c(t,"fill","currentColor"),_t(e,s)},m(i,a){C(i,e,a),d(e,r),d(e,t)},p(i,[a]){_t(e,s=Yt(l,[{width:"23"},{height:"23"},{fill:"none"},{xmlns:"http://www.w3.org/2000/svg"},a&1&&i[0]]))},i:F,o:F,d(i){i&&w(e)}}}function Hn(n,e,r){return n.$$set=t=>{r(0,e=T(T({},e),ve(t)))},e=ve(e),[e]}class en extends N{constructor(e){super(),Q(this,e,Hn,Un,A,{})}}var ge=(n=>(n[n.OK=200]="OK",n[n.Created=201]="Created",n[n.MultipleChoices=300]="MultipleChoices",n[n.NoContent=204]="NoContent",n[n.UnprocessableEntity=422]="UnprocessableEntity",n[n.Forbidden=403]="Forbidden",n[n.NotFound=404]="NotFound",n[n.BadRequest=400]="BadRequest",n))(ge||{}),Gn={delete:"Supprimer",deleteConfirm:"Voulez vous vraiment supprimer ce fichier ?",newFolderPlaceholder:"Nom du dossier",emptyTitle:"Ce dossier est vide",deleteFolder:"Supprimer le dossier",emptyDescription:"Déposer un fichier ici pour le téléverser",createFolder:"Créer un dossier",copy:"Copier le lien",size:"Taille",filename:"Nom",serverError:"Action impossible suite a une erreur serveur"};const st={delete:"Delete",deleteConfirm:"Do you really want to delete this file ?",newFolderPlaceholder:"Folder name",deleteFolder:"Delete this folder",emptyTitle:"This folder is empty",emptyDescription:"Drop a file here to upload it",createFolder:"New folder",copy:"Copy link",size:"Size",filename:"Name",serverError:"Server error"},wt={fr:Gn,en:st};let tn=st;function U(n){return tn[n]}function Jn(n){tn=n in wt?wt[n]:st}const Ie=ye([]),_e=(n,e="success")=>{const r=Date.now();Ie.update(t=>[{type:e,message:n,id:r},...t]),e==="success"&&window.setTimeout(()=>{Ie.update(t=>t.filter(l=>l.id!==r))},2e3)},Wn=n=>{Ie.update(e=>e.filter(r=>r.id!==n))},ot=n=>`files/${n??""}`,Ee=n=>`folders/${n??""}`,nn=ye(null),Fe=nn,qe=ye(""),Yn=async(n,e,r)=>{const t=ot(r.folder),l=e.getQueryData(t);l&&e.setQueryData(t,s=>s?s.filter(i=>i.id!==r.id):[]);try{await n.deleteFile(r)}catch(s){(!(s instanceof Response)||s.status!==ge.UnprocessableEntity)&&(_e(U("serverError"),"danger"),console.error(s)),e.setQueryData(t,l)}},rn=async(n,e,r,t)=>{try{const l=await n.uploadFile(r,t),s=ot(t==null?void 0:t.id),i=e.getQueryState(s);i!=null&&i.data&&e.setQueryData(s,a=>a?[l,...a]:[l])}catch(l){(!(l instanceof Response)||l.status!==ge.UnprocessableEntity)&&(_e(U("serverError"),"danger"),console.error(l))}},Xn=()=>{const n=$e(),e=re();return Tt(r=>e.createFolder(r),{onSuccess(r){const t=l=>{const s=Ee(l),i=n.getQueryState(s);i!=null&&i.data&&n.setQueryData(s,a=>a?[r,...a]:[r])};t(r.parent),r.parent&&t(null)}})},Tn=()=>{const n=$e(),e=re();return Tt(r=>e.deleteFolder(r).then(t=>r),{onSuccess:r=>{nn.update(()=>null);const t=l=>{const s=Ee(l),i=n.getQueryState(s);i!=null&&i.data&&n.setQueryData(Ee(l),a=>a?a.filter(o=>o.id!==r.id):[])};t(r.parent),t()}})},xn=300,We=ye([]),Ye=new Map,tt={push(n){const e=setTimeout(()=>{We.update(r=>[n,...r])},xn);Ye.set(n,e)},remove(n){const e=Ye.get(n);e!==void 0&&(clearTimeout(e),Ye.delete(n)),We.update(r=>r.filter(t=>t!==n))},subscribe:We.subscribe};function re(){return Jt("options")}function Xe(n,e,r){return e.forEach(t=>{n.addEventListener(t,r)}),()=>{e.forEach(t=>{n.removeEventListener(t,r)})}}function ln(n){const e=Xe(n,["drag","dragstart","dragend","dragover","dragenter","dragleave","drop"],function(l){l.preventDefault(),l.stopPropagation()}),r=Xe(n,["dragover","dragenter"],function(){n.dispatchEvent(new CustomEvent("dropzoneover"))}),t=Xe(n,["dragleave","dragend","drop"],function(){n.dispatchEvent(new CustomEvent("dropzoneleave"))});return{destroy(){e(),r(),t()}}}function er(n){let e,r,t;return{c(){e=j("svg"),r=j("path"),t=j("path"),c(r,"stroke","currentColor"),c(r,"stroke-linecap","round"),c(r,"stroke-width","2"),c(r,"d","M12 12H8m4-4v4-4Zm0 4v4-4Zm0 0h4-4Z"),c(t,"stroke","currentColor"),c(t,"stroke-width","2"),c(t,"d","M12 22a10 10 0 1 0 0-20 10 10 0 0 0 0 20Z"),c(e,"xmlns","http://www.w3.org/2000/svg"),c(e,"fill","none"),c(e,"width",n[0]),c(e,"height",n[0]),c(e,"viewBox","0 0 24 24")},m(l,s){C(l,e,s),d(e,r),d(e,t)},p(l,[s]){s&1&&c(e,"width",l[0]),s&1&&c(e,"height",l[0])},i:F,o:F,d(l){l&&w(e)}}}function tr(n,e,r){let{size:t=24}=e;return n.$$set=l=>{"size"in l&&r(0,t=l.size)},[t]}class nr extends N{constructor(e){super(),Q(this,e,tr,er,A,{size:0})}}function rr(n){return n.focus(),{}}function lr(n){let e,r;return{c(){e=j("svg"),r=j("path"),c(r,"fill","currentColor"),c(r,"fill-rule","evenodd"),c(r,"d","M0 8a1 1 0 0 1 1-1h11.58L8.3 2.7a1 1 0 1 1 1.42-1.4l6 6a1 1 0 0 1 0 1.4l-6 6a1 1 0 0 1-1.42-1.4L12.6 9H1a1 1 0 0 1-1-1Z"),c(r,"clip-rule","evenodd"),c(e,"xmlns","http://www.w3.org/2000/svg"),c(e,"fill","none"),c(e,"viewBox","0 0 16 16"),c(e,"width",n[0]),c(e,"height",n[0])},m(t,l){C(t,e,l),d(e,r)},p(t,[l]){l&1&&c(e,"width",t[0]),l&1&&c(e,"height",t[0])},i:F,o:F,d(t){t&&w(e)}}}function ir(n,e,r){let{size:t=16}=e;return n.$$set=l=>{"size"in l&&r(0,t=l.size)},[t]}class sr extends N{constructor(e){super(),Q(this,e,ir,lr,A,{size:0})}}function or(n){let e,r;const t=n[2].default,l=Be(t,n,n[1],null);let s=[n[0]],i={};for(let a=0;a<s.length;a+=1)i=T(i,s[a]);return{c(){e=y("button"),l&&l.c(),gt(e,i),W(e,"svelte-ms51de",!0)},m(a,o){C(a,e,o),l&&l.m(e,null),e.autofocus&&e.focus(),r=!0},p(a,[o]){l&&l.p&&(!r||o&2)&&Re(l,t,a,a[1],r?Pe(t,a[1],o,null):Ve(a[1]),null),gt(e,i=Yt(s,[o&1&&a[0]])),W(e,"svelte-ms51de",!0)},i(a){r||(m(l,a),r=!0)},o(a){g(l,a),r=!1},d(a){a&&w(e),l&&l.d(a)}}}function ar(n,e,r){let{$$slots:t={},$$scope:l}=e;return n.$$set=s=>{r(0,e=T(T({},e),ve(s))),"$$scope"in s&&r(1,l=s.$$scope)},e=ve(e),[e,l,t]}class ur extends N{constructor(e){super(),Q(this,e,ar,or,A,{})}}function cr(n){let e,r;return e=new sr({props:{size:12}}),{c(){q(e.$$.fragment)},m(t,l){D(e,t,l),r=!0},i(t){r||(m(e.$$.fragment,t),r=!0)},o(t){g(e.$$.fragment,t),r=!1},d(t){M(e,t)}}}function fr(n){let e,r;return e=new Ze({props:{size:12}}),{c(){q(e.$$.fragment)},m(t,l){D(e,t,l),r=!0},i(t){r||(m(e.$$.fragment,t),r=!0)},o(t){g(e.$$.fragment,t),r=!1},d(t){M(e,t)}}}function dr(n){let e,r,t,l;const s=[fr,cr],i=[];function a(o,u){return o[0].isLoading?0:1}return e=a(n),r=i[e]=s[e](n),{c(){r.c(),t=ue()},m(o,u){i[e].m(o,u),C(o,t,u),l=!0},p(o,u){let f=e;e=a(o),e!==f&&(Z(),g(i[f],1,1,()=>{i[f]=null}),K(),r=i[e],r||(r=i[e]=s[e](o),r.c()),m(r,1),r.m(t.parentNode,t))},i(o){l||(m(r),l=!0)},o(o){g(r),l=!1},d(o){i[e].d(o),o&&w(t)}}}function hr(n){let e,r,t,l,s,i,a,o,u,f;return r=new en({}),a=new ur({props:{disabled:n[0].isLoading,$$slots:{default:[dr]},$$scope:{ctx:n}}}),{c(){e=y("form"),q(r.$$.fragment),t=O(),l=y("input"),i=O(),q(a.$$.fragment),c(l,"type","text"),c(l,"placeholder",U("newFolderPlaceholder")),c(l,"name","name"),l.required=!0,l.disabled=s=n[0].isLoading,c(l,"class","svelte-bopbht"),c(e,"action",""),c(e,"class","fm-folder-form svelte-bopbht")},m(h,v){C(h,e,v),D(r,e,null),d(e,t),d(e,l),d(e,i),D(a,e,null),o=!0,u||(f=[ee(rr.call(null,l)),V(e,"submit",ae(n[2])),ee(Xt.call(null,e)),V(e,"outclick",n[3])],u=!0)},p(h,[v]){(!o||v&1&&s!==(s=h[0].isLoading))&&(l.disabled=s);const _={};v&1&&(_.disabled=h[0].isLoading),v&65&&(_.$$scope={dirty:v,ctx:h}),a.$set(_)},i(h){o||(m(r.$$.fragment,h),m(a.$$.fragment,h),o=!0)},o(h){g(r.$$.fragment,h),g(a.$$.fragment,h),o=!1},d(h){h&&w(e),M(r),M(a),u=!1,G(f)}}}function mr(n,e,r){let t,{parent:l}=e;const s=Xn();J(n,s,u=>r(0,t=u));const i=async u=>{const f=new FormData(u.currentTarget).get("name").toString();await t.mutateAsync({name:f,parent:l==null?void 0:l.id}),o("submit")},a=()=>{o("cancel")},o=kn();return n.$$set=u=>{"parent"in u&&r(4,l=u.parent)},[t,s,i,a,l]}class pr extends N{constructor(e){super(),Q(this,e,mr,hr,A,{parent:4})}}function gr(n){const e=n.map(t=>Le(ne({},t),{children:[]})),r=e.reduce((t,l)=>t.set(l.id,l),new Map);for(const t of e){const l=r.get(t.parent);t.parent&&l&&(l.children=l.children?[...l.children,t]:[t])}return e}function Ke(n,e){let r=null;const t=()=>{if(r)return;const l=n.getBoundingClientRect();r=document.createElement("div"),r.classList.add("fm-tooltip"),r.innerText=e,n.closest(".fm-root").appendChild(r),r.style.setProperty("transform",`translate(calc(${l.left+l.width/2}px - 50%), calc(${l.top-4}px - 100%))`),r.animate([{opacity:0},{opacity:1}],{duration:200,easing:"ease-in-out"}),n.addEventListener("pointerleave",()=>{r&&(r.animate([{opacity:1},{opacity:0}],{duration:200,easing:"ease-in-out"}),window.setTimeout(()=>{r==null||r.remove(),r=null},200))},{once:!0})};return n.addEventListener("pointerenter",t),{destroy(){r==null||r.remove(),n.removeEventListener("pointerenter",t)}}}function _r(n){let e,r;return e=new en({props:{class:"folder-icon"}}),{c(){q(e.$$.fragment)},m(t,l){D(e,t,l),r=!0},i(t){r||(m(e.$$.fragment,t),r=!0)},o(t){g(e.$$.fragment,t),r=!1},d(t){M(e,t)}}}function vr(n){let e,r;return e=new Ze({props:{size:20,class:"folder-loader"}}),{c(){q(e.$$.fragment)},m(t,l){D(e,t,l),r=!0},i(t){r||(m(e.$$.fragment,t),r=!0)},o(t){g(e.$$.fragment,t),r=!1},d(t){M(e,t)}}}function br(n){let e,r,t,l,s;return r=new nr({props:{size:16}}),{c(){e=y("button"),q(r.$$.fragment),c(e,"class","fm-new-folder svelte-1nyuu78")},m(i,a){C(i,e,a),D(r,e,null),t=!0,l||(s=[V(e,"click",ae(n[12])),ee(Ke.call(null,e,U("createFolder")))],l=!0)},p:F,i(i){t||(m(r.$$.fragment,i),t=!0)},o(i){g(r.$$.fragment,i),t=!1},d(i){i&&w(e),M(r),l=!1,G(s)}}}function kt(n){let e,r;return e=new pr({props:{parent:n[0]}}),e.$on("submit",n[13]),e.$on("cancel",n[13]),{c(){q(e.$$.fragment)},m(t,l){D(e,t,l),r=!0},p(t,l){const s={};l&1&&(s.parent=t[0]),e.$set(s)},i(t){r||(m(e.$$.fragment,t),r=!0)},o(t){g(e.$$.fragment,t),r=!1},d(t){M(e,t)}}}function yr(n){let e,r;return e=new at({props:{folders:n[6],lazyLoad:n[1]}}),{c(){q(e.$$.fragment)},m(t,l){D(e,t,l),r=!0},p(t,l){const s={};l&64&&(s.folders=t[6]),l&2&&(s.lazyLoad=t[1]),e.$set(s)},i(t){r||(m(e.$$.fragment,t),r=!0)},o(t){g(e.$$.fragment,t),r=!1},d(t){M(e,t)}}}function $r(n){var e;let r,t;return r=new at({props:{folders:(e=n[0])==null?void 0:e.children,lazyLoad:n[1]}}),{c(){q(r.$$.fragment)},m(l,s){D(r,l,s),t=!0},p(l,s){var i;const a={};s&1&&(a.folders=(i=l[0])==null?void 0:i.children),s&2&&(a.lazyLoad=l[1]),r.$set(a)},i(l){t||(m(r.$$.fragment,l),t=!0)},o(l){g(r.$$.fragment,l),t=!1},d(l){M(r,l)}}}function wr(n){var e,r;let t,l,s,i,a,o,u,f=((r=(e=n[0])==null?void 0:e.name)!=null?r:"/")+"",h,v,_,k,b,p,$,B,z;const L=[vr,_r],E=[];function R(S,H){return S[2].isLoading?0:1}i=R(n),a=E[i]=L[i](n);let P=!n[8].readOnly&&br(n),I=n[4]&&kt(n);const ut=[$r,yr],le=[];function ct(S,H){var we;return(we=S[0])!=null&&we.children&&S[5]?0:S[6]&&S[5]?1:-1}return~(b=ct(n))&&(p=le[b]=ut[b](n)),{c(){var S,H;t=y("li"),l=y("span"),s=y("span"),a.c(),o=O(),u=y("span"),h=te(f),v=O(),P&&P.c(),_=O(),I&&I.c(),k=O(),p&&p.c(),c(u,"class","fm-folder-name svelte-1nyuu78"),c(s,"class","fm-folder svelte-1nyuu78"),c(l,"class","fm-folder-wrapper svelte-1nyuu78"),W(l,"active",((S=n[0])==null?void 0:S.id)===((H=n[7])==null?void 0:H.id)||n[3])},m(S,H){C(S,t,H),d(t,l),d(l,s),E[i].m(s,null),d(s,o),d(s,u),d(u,h),d(l,v),P&&P.m(l,null),d(t,_),I&&I.m(t,null),d(t,k),~b&&le[b].m(t,null),$=!0,B||(z=[ee(ln.call(null,s)),V(s,"click",ae(n[14])),V(s,"dropzoneover",n[9]),V(s,"dropzoneleave",n[10]),V(s,"drop",n[11])],B=!0)},p(S,[H]){var we,ft,dt,ht;let Ue=i;i=R(S),i!==Ue&&(Z(),g(E[Ue],1,1,()=>{E[Ue]=null}),K(),a=E[i],a||(a=E[i]=L[i](S),a.c()),m(a,1),a.m(s,o)),(!$||H&1)&&f!==(f=((ft=(we=S[0])==null?void 0:we.name)!=null?ft:"/")+"")&&be(h,f),S[8].readOnly||P.p(S,H),H&137&&W(l,"active",((dt=S[0])==null?void 0:dt.id)===((ht=S[7])==null?void 0:ht.id)||S[3]),S[4]?I?(I.p(S,H),H&16&&m(I,1)):(I=kt(S),I.c(),m(I,1),I.m(t,k)):I&&(Z(),g(I,1,1,()=>{I=null}),K());let He=b;b=ct(S),b===He?~b&&le[b].p(S,H):(p&&(Z(),g(le[He],1,1,()=>{le[He]=null}),K()),~b?(p=le[b],p?p.p(S,H):(p=le[b]=ut[b](S),p.c()),m(p,1),p.m(t,null)):p=null)},i(S){$||(m(a),m(P),m(I),m(p),$=!0)},o(S){g(a),g(P),g(I),g(p),$=!1},d(S){S&&w(t),E[i].d(),P&&P.d(),I&&I.d(),~b&&le[b].d(),B=!1,G(z)}}}function kr(n,e,r){let t,l;J(n,Fe,L=>r(7,l=L));const s=$e();let{folder:i}=e,{lazyLoad:a}=e,o=!1,u=!1,f=!(i!=null&&i.id);const h=re(),v=()=>{h.readOnly||r(3,o=!0)},_=()=>{h.readOnly||r(3,o=!1)},k=L=>{h.readOnly&&L.preventDefault(),Array.from(L.dataTransfer.files).forEach(E=>rn(h,s,E,i))},b=()=>{r(4,u=!0),r(5,f=!0),!t.isSuccess&&(i==null?void 0:i.children)===void 0&&t.refetch()},p=()=>{r(4,u=!1)},$=()=>{if(f&&l===i){r(5,f=!1);return}r(5,f=!0),Vt(Fe,l=i,l),(i==null?void 0:i.children)===void 0&&t.refetch()},B=et(Ee(i==null?void 0:i.id),()=>h.getFolders(i!=null&&i.id?i:void 0),{enabled:!(i!=null&&i.id)});J(n,B,L=>r(2,t=L));let z=null;return n.$$set=L=>{"folder"in L&&r(0,i=L.folder),"lazyLoad"in L&&r(1,a=L.lazyLoad)},n.$$.update=()=>{n.$$.dirty&7&&t.isSuccess&&r(6,z=(a?t.data:gr(t.data)).filter(L=>{var E,R;return((E=L.parent)!=null?E:null)===((R=i==null?void 0:i.id)!=null?R:null)}))},[i,a,t,o,u,f,z,l,h,v,_,k,b,p,$,B]}class Cr extends N{constructor(e){super(),Q(this,e,kr,wr,A,{folder:0,lazyLoad:1})}}function Ct(n,e,r){const t=n.slice();return t[2]=e[r],t}function zt(n){let e,r;return e=new Cr({props:{folder:n[2],lazyLoad:n[1]}}),{c(){q(e.$$.fragment)},m(t,l){D(e,t,l),r=!0},p(t,l){const s={};l&1&&(s.folder=t[2]),l&2&&(s.lazyLoad=t[1]),e.$set(s)},i(t){r||(m(e.$$.fragment,t),r=!0)},o(t){g(e.$$.fragment,t),r=!1},d(t){M(e,t)}}}function zr(n){let e,r,t=n[0],l=[];for(let i=0;i<t.length;i+=1)l[i]=zt(Ct(n,t,i));const s=i=>g(l[i],1,1,()=>{l[i]=null});return{c(){e=y("ul");for(let i=0;i<l.length;i+=1)l[i].c();c(e,"class","fm-folders svelte-1spuanm")},m(i,a){C(i,e,a);for(let o=0;o<l.length;o+=1)l[o].m(e,null);r=!0},p(i,[a]){if(a&3){t=i[0];let o;for(o=0;o<t.length;o+=1){const u=Ct(i,t,o);l[o]?(l[o].p(u,a),m(l[o],1)):(l[o]=zt(u),l[o].c(),m(l[o],1),l[o].m(e,null))}for(Z(),o=t.length;o<l.length;o+=1)s(o);K()}},i(i){if(!r){for(let a=0;a<t.length;a+=1)m(l[a]);r=!0}},o(i){l=l.filter(Boolean);for(let a=0;a<l.length;a+=1)g(l[a]);r=!1},d(i){i&&w(e),De(l,i)}}}function Lr(n,e,r){let{folders:t}=e,{lazyLoad:l}=e;return n.$$set=s=>{"folders"in s&&r(0,t=s.folders),"lazyLoad"in s&&r(1,l=s.lazyLoad)},[t,l]}class at extends N{constructor(e){super(),Q(this,e,Lr,zr,A,{folders:0,lazyLoad:1})}}function Er(n){let e,r,t;return{c(){e=j("svg"),r=j("path"),t=j("path"),c(r,"d","M0 6.417a6.424 6.424 0 006.417 6.416 6.424 6.424 0 006.416-6.416A6.424 6.424 0 006.417 0 6.424 6.424 0 000 6.417zm1.833 0a4.589 4.589 0 014.584-4.584A4.589 4.589 0 0111 6.417 4.589 4.589 0 016.417 11a4.589 4.589 0 01-4.584-4.583z"),c(r,"fill","currentColor"),c(t,"d","M13.75 12.543L11.707 10.5c-.35.452-.755.856-1.207 1.207l2.043 2.043a.851.851 0 001.207 0 .853.853 0 000-1.207z"),c(t,"fill","currentColor"),c(e,"width","14"),c(e,"height","14"),c(e,"fill","none"),c(e,"xmlns","http://www.w3.org/2000/svg")},m(l,s){C(l,e,s),d(e,r),d(e,t)},p:F,i:F,o:F,d(l){l&&w(e)}}}class Fr extends N{constructor(e){super(),Q(this,e,null,Er,A,{})}}function Dr(n){let e,r,t,l,s,i,a,o;return s=new Fr({}),{c(){e=y("form"),r=y("input"),t=O(),l=y("button"),q(s.$$.fragment),c(r,"type","search"),c(r,"name","search"),c(r,"placeholder","e.g. image.png"),c(r,"class","svelte-15kvubs"),c(l,"title","Search"),c(l,"class","svelte-15kvubs"),c(e,"class","search svelte-15kvubs")},m(u,f){C(u,e,f),d(e,r),vt(r,n[0]),d(e,t),d(e,l),D(s,l,null),i=!0,a||(o=V(r,"input",n[1]),a=!0)},p(u,[f]){f&1&&vt(r,u[0])},i(u){i||(m(s.$$.fragment,u),i=!0)},o(u){g(s.$$.fragment,u),i=!1},d(u){u&&w(e),M(s),a=!1,o()}}}function Mr(n,e,r){let t;J(n,qe,s=>r(0,t=s)),Fe.subscribe(()=>{Vt(qe,t="",t)});function l(){t=this.value,qe.set(t)}return[t,l]}class Or extends N{constructor(e){super(),Q(this,e,Mr,Dr,A,{})}}function qr(n){let e,r,t,l,s;return r=new Or({}),l=new at({props:{folders:[null],lazyLoad:n[0]}}),{c(){e=y("aside"),q(r.$$.fragment),t=O(),q(l.$$.fragment),c(e,"class","fm-sidebar svelte-jz8ywq")},m(i,a){C(i,e,a),D(r,e,null),d(e,t),D(l,e,null),s=!0},p(i,[a]){const o={};a&1&&(o.lazyLoad=i[0]),l.$set(o)},i(i){s||(m(r.$$.fragment,i),m(l.$$.fragment,i),s=!0)},o(i){g(r.$$.fragment,i),g(l.$$.fragment,i),s=!1},d(i){i&&w(e),M(r),M(l)}}}function Sr(n,e,r){let{lazyFolders:t}=e;return n.$$set=l=>{"lazyFolders"in l&&r(0,t=l.lazyFolders)},[t]}class Ar extends N{constructor(e){super(),Q(this,e,Sr,qr,A,{lazyFolders:0})}}function jr(n){let e,r,t,l;return{c(){e=j("svg"),r=j("path"),t=j("path"),c(r,"d","M21.12 21.1765L3.83997 21.1765L3.83997 19.7647C3.83997 18.985 3.19526 18.3529 2.39997 18.3529C1.60468 18.3529 0.959966 18.985 0.959966 19.7647L0.959966 22.5882C0.959966 22.9781 1.12114 23.331 1.38173 23.5865C1.64232 23.842 2.00232 24 2.39997 24L22.56 24C22.7541 24 22.9393 23.9623 23.1084 23.894C23.6317 23.6826 24 23.1776 24 22.5882L24 19.7647C24 18.985 23.3553 18.3529 22.56 18.3529C21.7647 18.3529 21.12 18.985 21.12 19.7647L21.12 21.1765Z"),c(r,"fill","currentColor"),c(t,"d","M18.884 10.0314C18.6841 9.93335 18.4636 9.88232 18.2401 9.88232C17.9285 9.88232 17.6253 9.9814 17.3761 10.1647L13.92 12.7159C13.92 12.7125 13.92 12.7092 13.92 12.7059L13.92 1.41176C13.92 1.03734 13.7683 0.67825 13.4983 0.413493C13.2282 0.148736 12.862 -2.98024e-06 12.48 -3.01363e-06C12.0981 -3.04702e-06 11.7319 0.148736 11.4618 0.413493C11.1918 0.67825 11.04 1.03734 11.04 1.41176L11.04 12.7059C11.04 12.7325 11.0408 12.7591 11.0423 12.7855L7.55526 10.3764C7.40048 10.2681 7.22535 10.1909 7.03998 10.1493C6.85461 10.1077 6.66267 10.1025 6.47523 10.134C6.2878 10.1655 6.10858 10.233 5.94794 10.3328C5.78729 10.4326 5.64839 10.5626 5.53926 10.7153C5.32063 11.0207 5.23426 11.3986 5.29902 11.7664C5.36378 12.1341 5.57441 12.4617 5.88485 12.6776L11.6449 16.6588C11.8915 16.8355 12.189 16.9307 12.4945 16.9307C12.7999 16.9307 13.0974 16.8355 13.3441 16.6588L19.1041 12.4235C19.2553 12.3123 19.3828 12.1729 19.4791 12.0134C19.5755 11.8538 19.6388 11.6773 19.6656 11.4937C19.6923 11.3102 19.6819 11.1233 19.635 10.9437C19.5881 10.7641 19.5055 10.5953 19.3921 10.447C19.2579 10.2717 19.084 10.1294 18.884 10.0314Z"),c(t,"fill","currentColor"),c(t,"class",l=Ae(n[0]?"animatedArrow":null)+" svelte-1k824dx"),c(e,"width","24"),c(e,"height","24"),c(e,"viewBox","0 0 24 24"),c(e,"fill","none"),c(e,"xmlns","http://www.w3.org/2000/svg")},m(s,i){C(s,e,i),d(e,r),d(e,t)},p(s,[i]){i&1&&l!==(l=Ae(s[0]?"animatedArrow":null)+" svelte-1k824dx")&&c(t,"class",l)},i:F,o:F,d(s){s&&w(e)}}}function Qr(n,e,r){let{animated:t}=e;return n.$$set=l=>{"animated"in l&&r(0,t=l.animated)},[t]}class Nr extends N{constructor(e){super(),Q(this,e,Qr,jr,A,{animated:0})}}function Ir(n){let e,r,t,l,s,i,a;const o=n[6].default,u=Be(o,n,n[5],null);return l=new Nr({props:{animated:n[0]}}),{c(){e=y("main"),u&&u.c(),r=O(),t=y("span"),q(l.$$.fragment),c(t,"class","fm-dropzone svelte-lkheja"),W(t,"active",n[0]),c(e,"class","fm-main svelte-lkheja")},m(f,h){C(f,e,h),u&&u.m(e,null),d(e,r),d(e,t),D(l,t,null),s=!0,i||(a=[ee(ln.call(null,e)),V(e,"dropzoneover",n[1]),V(e,"dropzoneleave",n[2]),V(e,"drop",n[4])],i=!0)},p(f,h){u&&u.p&&(!s||h&32)&&Re(u,o,f,f[5],s?Pe(o,f[5],h,null):Ve(f[5]),null);const v={};h&1&&(v.animated=f[0]),l.$set(v),h&1&&W(t,"active",f[0])},i(f){s||(m(u,f),m(l.$$.fragment,f),s=!0)},o(f){g(u,f),g(l.$$.fragment,f),s=!1},d(f){f&&w(e),u&&u.d(f),M(l),i=!1,G(a)}}}function Br(n){let e,r;const t=n[6].default,l=Be(t,n,n[5],null);return{c(){e=y("main"),l&&l.c(),c(e,"class","fm-main svelte-lkheja")},m(s,i){C(s,e,i),l&&l.m(e,null),r=!0},p(s,i){l&&l.p&&(!r||i&32)&&Re(l,t,s,s[5],r?Pe(t,s[5],i,null):Ve(s[5]),null)},i(s){r||(m(l,s),r=!0)},o(s){g(l,s),r=!1},d(s){s&&w(e),l&&l.d(s)}}}function Pr(n){let e,r,t,l;const s=[Br,Ir],i=[];function a(o,u){return o[3].readOnly?0:1}return e=a(n),r=i[e]=s[e](n),{c(){r.c(),t=ue()},m(o,u){i[e].m(o,u),C(o,t,u),l=!0},p(o,[u]){r.p(o,u)},i(o){l||(m(r),l=!0)},o(o){g(r),l=!1},d(o){i[e].d(o),o&&w(t)}}}function Rr(n,e,r){let t;J(n,Fe,v=>r(7,t=v));let{$$slots:l={},$$scope:s}=e,i=!1;const a=()=>r(0,i=!0),o=()=>r(0,i=!1),u=$e(),f=re(),h=v=>{Array.from(v.dataTransfer.files).forEach(async _=>{tt.push(_),await rn(f,u,_,t),tt.remove(_)})};return n.$$set=v=>{"$$scope"in v&&r(5,s=v.$$scope)},[i,a,o,f,h,s,l]}class Vr extends N{constructor(e){super(),Q(this,e,Rr,Pr,A,{})}}function Lt(n,e,r){const t=n.slice();return t[1]=e[r],t}function Et(n){let e,r,t=n[0],l=[];for(let i=0;i<t.length;i+=1)l[i]=Ft(Lt(n,t,i));const s=i=>g(l[i],1,1,()=>{l[i]=null});return{c(){e=y("aside");for(let i=0;i<l.length;i+=1)l[i].c();c(e,"class","fm-upload-progress svelte-3nncjb")},m(i,a){C(i,e,a);for(let o=0;o<l.length;o+=1)l[o].m(e,null);r=!0},p(i,a){if(a&1){t=i[0];let o;for(o=0;o<t.length;o+=1){const u=Lt(i,t,o);l[o]?(l[o].p(u,a),m(l[o],1)):(l[o]=Ft(u),l[o].c(),m(l[o],1),l[o].m(e,null))}for(Z(),o=t.length;o<l.length;o+=1)s(o);K()}},i(i){if(!r){for(let a=0;a<t.length;a+=1)m(l[a]);r=!0}},o(i){l=l.filter(Boolean);for(let a=0;a<l.length;a+=1)g(l[a]);r=!1},d(i){i&&w(e),De(l,i)}}}function Ft(n){let e,r,t=n[1].name+"",l,s,i,a,o,u;return{c(){e=y("div"),r=y("div"),l=te(t),s=O(),i=y("div"),a=O(),c(i,"class","fm-upload-progress-bar svelte-3nncjb"),c(r,"class","fm-upload-progress-item svelte-3nncjb")},m(f,h){C(f,e,h),d(e,r),d(r,l),d(r,s),d(r,i),d(e,a),u=!0},p(f,h){(!u||h&1)&&t!==(t=f[1].name+"")&&be(l,t)},i(f){u||(oe(()=>{o||(o=ie(e,se,{x:20},!0)),o.run(1)}),u=!0)},o(f){o||(o=ie(e,se,{x:20},!1)),o.run(0),u=!1},d(f){f&&w(e),f&&o&&o.end()}}}function Zr(n){let e,r,t=n[0].length>0&&Et(n);return{c(){t&&t.c(),e=ue()},m(l,s){t&&t.m(l,s),C(l,e,s),r=!0},p(l,[s]){l[0].length>0?t?(t.p(l,s),s&1&&m(t,1)):(t=Et(l),t.c(),m(t,1),t.m(e.parentNode,e)):t&&(Z(),g(t,1,1,()=>{t=null}),K())},i(l){r||(m(t),r=!0)},o(l){g(t),r=!1},d(l){t&&t.d(l),l&&w(e)}}}function Kr(n,e,r){let t;return J(n,tt,l=>r(0,t=l)),[t]}class Ur extends N{constructor(e){super(),Q(this,e,Kr,Zr,A,{})}}function Hr(n){let e,r,t;return{c(){e=j("svg"),r=j("rect"),t=j("path"),c(r,"width","16"),c(r,"height","16"),c(r,"fill","white"),c(t,"fill-rule","evenodd"),c(t,"clip-rule","evenodd"),c(t,"d","M1 0H15C15.6 0 16 0.4 16 1V15C16 15.6 15.6 16 15 16H1C0.4 16 0 15.6 0 15V1C0 0.4 0.4 0 1 0ZM10.1 11.5L11.5 10.1L9.4 8L11.5 5.9L10.1 4.5L8 6.6L5.9 4.5L4.5 5.9L6.6 8L4.5 10.1L5.9 11.5L8 9.4L10.1 11.5Z"),c(t,"fill","currentColor"),c(e,"width","16"),c(e,"height","16"),c(e,"viewBox","0 0 16 16"),c(e,"fill","none"),c(e,"xmlns","http://www.w3.org/2000/svg")},m(l,s){C(l,e,s),d(e,r),d(e,t)},p:F,i:F,o:F,d(l){l&&w(e)}}}class sn extends N{constructor(e){super(),Q(this,e,null,Hr,A,{})}}function Gr(n){let e,r,t,l;return{c(){e=j("svg"),r=j("path"),t=j("path"),l=j("path"),c(r,"d","M7 8H1c-.6 0-1 .4-1 1v6c0 .6.4 1 1 1h6c.6 0 1-.4 1-1V9c0-.6-.4-1-1-1z"),c(r,"fill","currentColor"),c(t,"d","M11 4H2v2h8v8h2V5c0-.6-.4-1-1-1z"),c(t,"fill","currentColor"),c(l,"d","M15 0H6v2h8v8h2V1c0-.6-.4-1-1-1z"),c(l,"fill","currentColor"),c(e,"fill","none"),c(e,"xmlns","http://www.w3.org/2000/svg"),c(e,"width",n[0]),c(e,"height",n[0]),c(e,"viewBox","0 0 16 16")},m(s,i){C(s,e,i),d(e,r),d(e,t),d(e,l)},p(s,[i]){i&1&&c(e,"width",s[0]),i&1&&c(e,"height",s[0])},i:F,o:F,d(s){s&&w(e)}}}function Jr(n,e,r){let{size:t=16}=e;return n.$$set=l=>{"size"in l&&r(0,t=l.size)},[t]}class Wr extends N{constructor(e){super(),Q(this,e,Jr,Gr,A,{size:0})}}function on(n,e){const r=$e(),t=re();return{handleClick:()=>{e.dispatchEvent(new CustomEvent("selectfile",{detail:n,bubbles:!0}))},handleCopy:()=>{navigator.clipboard.writeText(n.url),_e("Le lien a été copié dans votre presse papier")},handleDelete:()=>{confirm(U("deleteConfirm"))&&Yn(t,r,n)}}}function an(n,e){return n.length<=e?n:n.slice(0,e-11)+"..."+n.slice(-8)}function Yr(n){let e,r,t,l,s;return r=new sn({}),{c(){e=y("button"),q(r.$$.fragment),c(e,"class","svelte-1ntuvox")},m(i,a){C(i,e,a),D(r,e,null),t=!0,l||(s=[ee(Ke.call(null,e,U("delete"))),V(e,"click",lt(ae(function(){x(n[3].handleDelete)&&n[3].handleDelete.apply(this,arguments)})))],l=!0)},p(i,a){n=i},i(i){t||(m(r.$$.fragment,i),t=!0)},o(i){g(r.$$.fragment,i),t=!1},d(i){i&&w(e),M(r),l=!1,G(s)}}}function Xr(n){let e,r,t,l,s,i,a,o,u,f,h,v=(n[0].size?n[5].format(n[0].size/1e3):null)+"",_,k,b,p,$,B,z,L,E;$=new Wr({});let R=!n[4].readOnly&&Yr(n);return{c(){e=y("tr"),r=y("td"),t=O(),l=y("td"),s=y("img"),a=O(),o=y("td"),u=te(n[2]),f=O(),h=y("td"),_=te(v),k=O(),b=y("td"),p=y("button"),q($.$$.fragment),B=O(),R&&R.c(),c(r,"class","svelte-1ntuvox"),Se(s.src,i=n[0].thumbnail)||c(s,"src",i),c(s,"alt",""),c(s,"class","svelte-1ntuvox"),c(l,"class","svelte-1ntuvox"),c(o,"class","filename svelte-1ntuvox"),c(h,"class","svelte-1ntuvox"),c(p,"class","svelte-1ntuvox"),c(b,"class","actions svelte-1ntuvox"),c(e,"class","svelte-1ntuvox")},m(P,I){C(P,e,I),d(e,r),d(e,t),d(e,l),d(l,s),d(e,a),d(e,o),d(o,u),d(e,f),d(e,h),d(h,_),d(e,k),d(e,b),d(b,p),D($,p,null),d(b,B),R&&R.m(b,null),n[6](e),z=!0,L||(E=[ee(Ke.call(null,p,U("copy"))),V(p,"click",lt(ae(function(){x(n[3].handleCopy)&&n[3].handleCopy.apply(this,arguments)}))),V(e,"click",function(){x(n[3].handleClick)&&n[3].handleClick.apply(this,arguments)})],L=!0)},p(P,[I]){n=P,(!z||I&1&&!Se(s.src,i=n[0].thumbnail))&&c(s,"src",i),(!z||I&4)&&be(u,n[2]),(!z||I&1)&&v!==(v=(n[0].size?n[5].format(n[0].size/1e3):null)+"")&&be(_,v),n[4].readOnly||R.p(n,I)},i(P){z||(m($.$$.fragment,P),m(R),z=!0)},o(P){g($.$$.fragment,P),g(R),z=!1},d(P){P&&w(e),M($),R&&R.d(),n[6](null),L=!1,G(E)}}}function Tr(n,e,r){let t,l,s;const i=re(),a=new Intl.NumberFormat(void 0,{style:"unit",unit:"kilobyte",unitDisplay:"short",maximumSignificantDigits:3});let{file:o}=e;function u(f){Ne[f?"unshift":"push"](()=>{s=f,r(1,s)})}return n.$$set=f=>{"file"in f&&r(0,o=f.file)},n.$$.update=()=>{n.$$.dirty&3&&r(3,t=on(o,s)),n.$$.dirty&1&&r(2,l=an(o.name,35))},[o,s,l,t,i,a,u]}class xr extends N{constructor(e){super(),Q(this,e,Tr,Xr,A,{file:0})}}function Dt(n,e,r){const t=n.slice();return t[1]=e[r],t}function Mt(n){let e,r;return e=new xr({props:{file:n[1]}}),{c(){q(e.$$.fragment)},m(t,l){D(e,t,l),r=!0},p(t,l){const s={};l&1&&(s.file=t[1]),e.$set(s)},i(t){r||(m(e.$$.fragment,t),r=!0)},o(t){g(e.$$.fragment,t),r=!1},d(t){M(e,t)}}}function el(n){let e,r,t,l,s,i,a,o,u,f,h,v,_,k,b,p=n[0],$=[];for(let z=0;z<p.length;z+=1)$[z]=Mt(Dt(n,p,z));const B=z=>g($[z],1,1,()=>{$[z]=null});return{c(){e=y("table"),r=y("thead"),t=y("tr"),l=y("th"),s=O(),i=y("th"),a=O(),o=y("th"),o.textContent=`${U("filename")}`,u=O(),f=y("th"),f.textContent=`${U("size")}`,h=O(),v=y("th"),_=O(),k=y("tbody");for(let z=0;z<$.length;z+=1)$[z].c();c(e,"class","svelte-88gfvn")},m(z,L){C(z,e,L),d(e,r),d(r,t),d(t,l),d(t,s),d(t,i),d(t,a),d(t,o),d(t,u),d(t,f),d(t,h),d(t,v),d(e,_),d(e,k);for(let E=0;E<$.length;E+=1)$[E].m(k,null);b=!0},p(z,[L]){if(L&1){p=z[0];let E;for(E=0;E<p.length;E+=1){const R=Dt(z,p,E);$[E]?($[E].p(R,L),m($[E],1)):($[E]=Mt(R),$[E].c(),m($[E],1),$[E].m(k,null))}for(Z(),E=p.length;E<$.length;E+=1)B(E);K()}},i(z){if(!b){for(let L=0;L<p.length;L+=1)m($[L]);b=!0}},o(z){$=$.filter(Boolean);for(let L=0;L<$.length;L+=1)g($[L]);b=!1},d(z){z&&w(e),De($,z)}}}function tl(n,e,r){let{files:t}=e;return n.$$set=l=>{"files"in l&&r(0,t=l.files)},[t]}class nl extends N{constructor(e){super(),Q(this,e,tl,el,A,{files:0})}}function rl(n){let e,r,t,l,s;return r=new sn({}),{c(){e=y("button"),q(r.$$.fragment),c(e,"class","fm-delete svelte-c91skb")},m(i,a){C(i,e,a),D(r,e,null),t=!0,l||(s=[ee(Ke.call(null,e,U("delete"))),V(e,"click",lt(ae(function(){x(n[2].handleDelete)&&n[2].handleDelete.apply(this,arguments)})))],l=!0)},p(i,a){n=i},i(i){t||(m(r.$$.fragment,i),t=!0)},o(i){g(r.$$.fragment,i),t=!1},d(i){i&&w(e),M(r),l=!1,G(s)}}}function ll(n){let e,r,t,l,s,i,a,o,u,f,h,v=!n[4].readOnly&&rl(n);return{c(){e=y("div"),r=y("div"),t=y("img"),s=O(),v&&v.c(),i=O(),a=y("div"),o=te(n[3]),Se(t.src,l=n[0].thumbnail)||c(t,"src",l),c(t,"alt",""),c(t,"class","svelte-c91skb"),c(r,"class","fm-thumbnail svelte-c91skb"),c(a,"class","fm-filename svelte-c91skb"),c(e,"class","fm-file svelte-c91skb")},m(_,k){C(_,e,k),d(e,r),d(r,t),d(r,s),v&&v.m(r,null),d(e,i),d(e,a),d(a,o),n[5](e),u=!0,f||(h=V(e,"click",function(){x(n[2].handleClick)&&n[2].handleClick.apply(this,arguments)}),f=!0)},p(_,[k]){n=_,(!u||k&1&&!Se(t.src,l=n[0].thumbnail))&&c(t,"src",l),n[4].readOnly||v.p(n,k),(!u||k&8)&&be(o,n[3])},i(_){u||(m(v),u=!0)},o(_){g(v),u=!1},d(_){_&&w(e),v&&v.d(),n[5](null),f=!1,h()}}}function il(n,e,r){let t,l,s;const i=re();let{file:a}=e;function o(u){Ne[u?"unshift":"push"](()=>{s=u,r(1,s)})}return n.$$set=u=>{"file"in u&&r(0,a=u.file)},n.$$.update=()=>{n.$$.dirty&1&&r(3,t=an(a.name,30)),n.$$.dirty&3&&r(2,l=on(a,s))},[a,s,l,t,i,o]}class sl extends N{constructor(e){super(),Q(this,e,il,ll,A,{file:0})}}function Ot(n,e,r){const t=n.slice();return t[1]=e[r],t}function qt(n){let e,r;return e=new sl({props:{file:n[1]}}),{c(){q(e.$$.fragment)},m(t,l){D(e,t,l),r=!0},p(t,l){const s={};l&1&&(s.file=t[1]),e.$set(s)},i(t){r||(m(e.$$.fragment,t),r=!0)},o(t){g(e.$$.fragment,t),r=!1},d(t){M(e,t)}}}function ol(n){let e,r,t=n[0],l=[];for(let i=0;i<t.length;i+=1)l[i]=qt(Ot(n,t,i));const s=i=>g(l[i],1,1,()=>{l[i]=null});return{c(){e=y("div");for(let i=0;i<l.length;i+=1)l[i].c();c(e,"class","grid svelte-trks37")},m(i,a){C(i,e,a);for(let o=0;o<l.length;o+=1)l[o].m(e,null);r=!0},p(i,[a]){if(a&1){t=i[0];let o;for(o=0;o<t.length;o+=1){const u=Ot(i,t,o);l[o]?(l[o].p(u,a),m(l[o],1)):(l[o]=qt(u),l[o].c(),m(l[o],1),l[o].m(e,null))}for(Z(),o=t.length;o<l.length;o+=1)s(o);K()}},i(i){if(!r){for(let a=0;a<t.length;a+=1)m(l[a]);r=!0}},o(i){l=l.filter(Boolean);for(let a=0;a<l.length;a+=1)g(l[a]);r=!1},d(i){i&&w(e),De(l,i)}}}function al(n,e,r){let{files:t}=e;return n.$$set=l=>{"files"in l&&r(0,t=l.files)},[t]}class ul extends N{constructor(e){super(),Q(this,e,al,ol,A,{files:0})}}function cl(n){let e,r,t,l,s,i,a=n[3]&&!n[5].readOnly&&St(n);return{c(){e=y("div"),r=y("p"),r.textContent=`${U("emptyTitle")}`,t=O(),l=y("p"),l.textContent=`${U("emptyDescription")}`,s=O(),a&&a.c(),c(r,"class","big svelte-mbr02"),c(l,"class","svelte-mbr02"),c(e,"class","empty svelte-mbr02")},m(o,u){C(o,e,u),d(e,r),d(e,t),d(e,l),d(e,s),a&&a.m(e,null),i=!0},p(o,u){o[3]&&!o[5].readOnly?a?(a.p(o,u),u&8&&m(a,1)):(a=St(o),a.c(),m(a,1),a.m(e,null)):a&&(Z(),g(a,1,1,()=>{a=null}),K())},i(o){i||(m(a),i=!0)},o(o){g(a),i=!1},d(o){o&&w(e),a&&a.d()}}}function fl(n){let e,r,t;return r=new Ze({}),{c(){e=y("div"),q(r.$$.fragment),c(e,"class","empty svelte-mbr02")},m(l,s){C(l,e,s),D(r,e,null),t=!0},p:F,i(l){t||(m(r.$$.fragment,l),t=!0)},o(l){g(r.$$.fragment,l),t=!1},d(l){l&&w(e),M(r)}}}function dl(n){let e,r,t,l;const s=[ml,hl],i=[];function a(o,u){return o[0]==="rows"?0:1}return e=a(n),r=i[e]=s[e](n),{c(){r.c(),t=ue()},m(o,u){i[e].m(o,u),C(o,t,u),l=!0},p(o,u){let f=e;e=a(o),e===f?i[e].p(o,u):(Z(),g(i[f],1,1,()=>{i[f]=null}),K(),r=i[e],r?r.p(o,u):(r=i[e]=s[e](o),r.c()),m(r,1),r.m(t.parentNode,t))},i(o){l||(m(r),l=!0)},o(o){g(r),l=!1},d(o){i[e].d(o),o&&w(t)}}}function St(n){let e,r,t=U("deleteFolder")+"",l,s,i,a,o,u=n[4].isLoading&&At();return{c(){e=y("button"),u&&u.c(),r=O(),l=te(t),c(e,"class","delete-folder svelte-mbr02"),e.disabled=s=n[4].isLoading},m(f,h){C(f,e,h),u&&u.m(e,null),d(e,r),d(e,l),i=!0,a||(o=V(e,"click",ae(n[7])),a=!0)},p(f,h){f[4].isLoading?u?h&16&&m(u,1):(u=At(),u.c(),m(u,1),u.m(e,r)):u&&(Z(),g(u,1,1,()=>{u=null}),K()),(!i||h&16&&s!==(s=f[4].isLoading))&&(e.disabled=s)},i(f){i||(m(u),i=!0)},o(f){g(u),i=!1},d(f){f&&w(e),u&&u.d(),a=!1,o()}}}function At(n){let e,r;return e=new Ze({props:{size:12}}),{c(){q(e.$$.fragment)},m(t,l){D(e,t,l),r=!0},i(t){r||(m(e.$$.fragment,t),r=!0)},o(t){g(e.$$.fragment,t),r=!1},d(t){M(e,t)}}}function hl(n){let e,r;return e=new ul({props:{files:n[2]}}),{c(){q(e.$$.fragment)},m(t,l){D(e,t,l),r=!0},p(t,l){const s={};l&4&&(s.files=t[2]),e.$set(s)},i(t){r||(m(e.$$.fragment,t),r=!0)},o(t){g(e.$$.fragment,t),r=!1},d(t){M(e,t)}}}function ml(n){let e,r;return e=new nl({props:{files:n[2]}}),{c(){q(e.$$.fragment)},m(t,l){D(e,t,l),r=!0},p(t,l){const s={};l&4&&(s.files=t[2]),e.$set(s)},i(t){r||(m(e.$$.fragment,t),r=!0)},o(t){g(e.$$.fragment,t),r=!1},d(t){M(e,t)}}}function pl(n){let e,r,t,l;const s=[dl,fl,cl],i=[];function a(o,u){return o[2].length>0?0:o[1].isLoading?1:2}return e=a(n),r=i[e]=s[e](n),{c(){r.c(),t=ue()},m(o,u){i[e].m(o,u),C(o,t,u),l=!0},p(o,[u]){let f=e;e=a(o),e===f?i[e].p(o,u):(Z(),g(i[f],1,1,()=>{i[f]=null}),K(),r=i[e],r?r.p(o,u):(r=i[e]=s[e](o),r.c()),m(r,1),r.m(t.parentNode,t))},i(o){l||(m(r),l=!0)},o(o){g(r),l=!1},d(o){i[e].d(o),o&&w(t)}}}function gl(n,e,r){let t,l,s,i,a;J(n,qe,p=>r(12,i=p));let{layout:o}=e,{folder:u}=e;const f=re(),h=Tn();J(n,h,p=>r(4,a=p));const v=()=>{u&&a.mutate(u)},_=et(ot(u==null?void 0:u.id),()=>re().getFiles(u));J(n,_,p=>r(1,l=p));let k=[];const b=et(Ee(u==null?void 0:u.id),()=>[],{enabled:!1});return J(n,b,p=>r(11,s=p)),n.$$set=p=>{"layout"in p&&r(0,o=p.layout),"folder"in p&&r(10,u=p.folder)},n.$$.update=()=>{var p,$;n.$$.dirty&4098&&r(2,k=l.isSuccess?l.data.filter(B=>i?B.name.includes(i):!0):[]),n.$$.dirty&3074&&r(3,t=(u==null?void 0:u.id)&&((u==null?void 0:u.children)&&u.children.length===0||s.isSuccess&&((p=s==null?void 0:s.data)==null?void 0:p.length)===0)&&l.isSuccess&&(($=l==null?void 0:l.data)==null?void 0:$.length)===0)},[o,l,k,t,a,f,h,v,_,b,u,s,i]}class _l extends N{constructor(e){super(),Q(this,e,gl,pl,A,{layout:0,folder:10})}}function vl(n){let e,r,t;return{c(){e=j("svg"),r=j("path"),t=j("path"),c(r,"stroke","currentColor"),c(r,"stroke-width","2"),c(r,"d","M12 22a10 10 0 1 0 0-20 10 10 0 0 0 0 20Z"),c(t,"stroke","currentColor"),c(t,"stroke-linecap","round"),c(t,"stroke-width","2"),c(t,"d","M12 16.5v.5m0-10v6-6Z"),c(e,"xmlns","http://www.w3.org/2000/svg"),c(e,"fill","none"),c(e,"viewBox","0 0 24 24"),c(e,"width",n[0]),c(e,"height",n[0])},m(l,s){C(l,e,s),d(e,r),d(e,t)},p(l,[s]){s&1&&c(e,"width",l[0]),s&1&&c(e,"height",l[0])},i:F,o:F,d(l){l&&w(e)}}}function bl(n,e,r){let{size:t=24}=e;return n.$$set=l=>{"size"in l&&r(0,t=l.size)},[t]}class yl extends N{constructor(e){super(),Q(this,e,bl,vl,A,{size:0})}}function $l(n){let e,r,t;return{c(){e=j("svg"),r=j("path"),t=j("path"),c(r,"stroke","currentColor"),c(r,"stroke-linecap","round"),c(r,"stroke-linejoin","round"),c(r,"stroke-width","2"),c(r,"d","m8 12.5 3 3 5-6"),c(t,"stroke","currentColor"),c(t,"stroke-width","2"),c(t,"d","M12 22a10 10 0 1 0 0-20 10 10 0 0 0 0 20Z"),c(e,"xmlns","http://www.w3.org/2000/svg"),c(e,"fill","none"),c(e,"viewBox","0 0 24 24"),c(e,"width",n[0]),c(e,"height",n[0])},m(l,s){C(l,e,s),d(e,r),d(e,t)},p(l,[s]){s&1&&c(e,"width",l[0]),s&1&&c(e,"height",l[0])},i:F,o:F,d(l){l&&w(e)}}}function wl(n,e,r){let{size:t=24}=e;return n.$$set=l=>{"size"in l&&r(0,t=l.size)},[t]}class kl extends N{constructor(e){super(),Q(this,e,wl,$l,A,{size:0})}}function Cl(n){let e,r,t,l;return e=new kl({}),{c(){q(e.$$.fragment),r=O(),t=y("div"),c(t,"class","fm-progress svelte-rcwbts")},m(s,i){D(e,s,i),C(s,r,i),C(s,t,i),l=!0},i(s){l||(m(e.$$.fragment,s),l=!0)},o(s){g(e.$$.fragment,s),l=!1},d(s){M(e,s),s&&w(r),s&&w(t)}}}function zl(n){let e,r;return e=new yl({}),{c(){q(e.$$.fragment)},m(t,l){D(e,t,l),r=!0},i(t){r||(m(e.$$.fragment,t),r=!0)},o(t){g(e.$$.fragment,t),r=!1},d(t){M(e,t)}}}function Ll(n){let e,r,t,l,s=n[0].message+"",i,a,o,u,f,h;const v=[zl,Cl],_=[];function k(b,p){return b[0].type==="danger"?0:b[0].type==="success"?1:-1}return~(r=k(n))&&(t=_[r]=v[r](n)),{c(){e=y("div"),t&&t.c(),l=O(),i=te(s),a=O(),o=y("button"),o.textContent="×",c(o,"class","fm-close svelte-rcwbts"),c(e,"class","fm-alert svelte-rcwbts"),W(e,"fm-danger",n[0].type==="danger"),W(e,"fm-success",n[0].type==="success")},m(b,p){C(b,e,p),~r&&_[r].m(e,null),d(e,l),d(e,i),d(e,a),d(e,o),u=!0,f||(h=V(o,"click",ae(n[1])),f=!0)},p(b,[p]){let $=r;r=k(b),r!==$&&(t&&(Z(),g(_[$],1,1,()=>{_[$]=null}),K()),~r?(t=_[r],t||(t=_[r]=v[r](b),t.c()),m(t,1),t.m(e,l)):t=null),(!u||p&1)&&s!==(s=b[0].message+"")&&be(i,s),p&1&&W(e,"fm-danger",b[0].type==="danger"),p&1&&W(e,"fm-success",b[0].type==="success")},i(b){u||(m(t),u=!0)},o(b){g(t),u=!1},d(b){b&&w(e),~r&&_[r].d(),f=!1,h()}}}function El(n,e,r){let{message:t}=e;const l=()=>{Wn(t.id)};return n.$$set=s=>{"message"in s&&r(0,t=s.message)},[t,l]}class Fl extends N{constructor(e){super(),Q(this,e,El,Ll,A,{message:0})}}function jt(n,e,r){const t=n.slice();return t[1]=e[r],t}function Qt(n){let e,r,t,l,s;return r=new Fl({props:{message:n[1]}}),{c(){e=y("div"),q(r.$$.fragment),t=O()},m(i,a){C(i,e,a),D(r,e,null),d(e,t),s=!0},p(i,a){const o={};a&1&&(o.message=i[1]),r.$set(o)},i(i){s||(m(r.$$.fragment,i),oe(()=>{l||(l=ie(e,se,{x:20},!0)),l.run(1)}),s=!0)},o(i){g(r.$$.fragment,i),l||(l=ie(e,se,{x:20},!1)),l.run(0),s=!1},d(i){i&&w(e),M(r),i&&l&&l.end()}}}function Dl(n){let e,r,t=n[0],l=[];for(let i=0;i<t.length;i+=1)l[i]=Qt(jt(n,t,i));const s=i=>g(l[i],1,1,()=>{l[i]=null});return{c(){e=y("div");for(let i=0;i<l.length;i+=1)l[i].c();c(e,"class","fm-wrapper svelte-1ja1s61")},m(i,a){C(i,e,a);for(let o=0;o<l.length;o+=1)l[o].m(e,null);r=!0},p(i,[a]){if(a&1){t=i[0];let o;for(o=0;o<t.length;o+=1){const u=jt(i,t,o);l[o]?(l[o].p(u,a),m(l[o],1)):(l[o]=Qt(u),l[o].c(),m(l[o],1),l[o].m(e,null))}for(Z(),o=t.length;o<l.length;o+=1)s(o);K()}},i(i){if(!r){for(let a=0;a<t.length;a+=1)m(l[a]);r=!0}},o(i){l=l.filter(Boolean);for(let a=0;a<l.length;a+=1)g(l[a]);r=!1},d(i){i&&w(e),De(l,i)}}}function Ml(n,e,r){let t;return J(n,Ie,l=>r(0,t=l)),[t]}class Ol extends N{constructor(e){super(),Q(this,e,Ml,Dl,A,{})}}function Nt(n){let e,r,t,l,s,i,a,o,u,f,h,v,_,k,b;return l=new Ar({props:{lazyFolders:n[2]}}),i=new Vr({props:{$$slots:{default:[ql]},$$scope:{ctx:n}}}),o=new Ol({}),f=new Ur({}),{c(){e=y("div"),r=y("div"),t=y("div"),q(l.$$.fragment),s=O(),q(i.$$.fragment),a=O(),q(o.$$.fragment),u=O(),q(f.$$.fragment),c(t,"class","fm-modal svelte-5hhtx0"),c(r,"class","fm-overlay svelte-5hhtx0"),c(e,"class","fm-root svelte-5hhtx0")},m(p,$){C(p,e,$),d(e,r),d(r,t),D(l,t,null),d(t,s),D(i,t,null),d(t,a),D(o,t,null),d(t,u),D(f,t,null),_=!0,k||(b=ee(Xt.call(null,t,"close")),k=!0)},p(p,$){const B={};$&4&&(B.lazyFolders=p[2]),l.$set(B);const z={};$&74&&(z.$$scope={dirty:$,ctx:p}),i.$set(z)},i(p){_||(m(l.$$.fragment,p),m(i.$$.fragment,p),m(o.$$.fragment,p),m(f.$$.fragment,p),oe(()=>{h||(h=ie(t,se,{y:-30,duration:500},!0)),h.run(1)}),oe(()=>{v||(v=ie(r,se,{duration:300},!0)),v.run(1)}),_=!0)},o(p){g(l.$$.fragment,p),g(i.$$.fragment,p),g(o.$$.fragment,p),g(f.$$.fragment,p),h||(h=ie(t,se,{y:-30,duration:500},!1)),h.run(0),v||(v=ie(r,se,{duration:300},!1)),v.run(0),_=!1},d(p){p&&w(e),M(l),M(i),M(o),M(f),p&&h&&h.end(),p&&v&&v.end(),k=!1,b()}}}function It(n){let e,r;return e=new _l({props:{folder:n[3],layout:n[1]}}),{c(){q(e.$$.fragment)},m(t,l){D(e,t,l),r=!0},p(t,l){const s={};l&8&&(s.folder=t[3]),l&2&&(s.layout=t[1]),e.$set(s)},i(t){r||(m(e.$$.fragment,t),r=!0)},o(t){g(e.$$.fragment,t),r=!1},d(t){M(e,t)}}}function ql(n){var e;let r=(e=n[3])==null?void 0:e.id,t,l,s=It(n);return{c(){s.c(),t=ue()},m(i,a){s.m(i,a),C(i,t,a),l=!0},p(i,a){var o;a&8&&A(r,r=(o=i[3])==null?void 0:o.id)?(Z(),g(s,1,1,F),K(),s=It(i),s.c(),m(s),s.m(t.parentNode,t)):s.p(i,a)},i(i){l||(m(s),l=!0)},o(i){g(s),l=!1},d(i){i&&w(t),s.d(i)}}}function Sl(n){let e,r,t=!n[0]&&Nt(n);return{c(){t&&t.c(),e=ue()},m(l,s){t&&t.m(l,s),C(l,e,s),r=!0},p(l,s){l[0]?t&&(Z(),g(t,1,1,()=>{t=null}),K()):t?(t.p(l,s),s&1&&m(t,1)):(t=Nt(l),t.c(),m(t,1),t.m(e.parentNode,e))},i(l){r||(m(t),r=!0)},o(l){g(t),r=!1},d(l){t&&t.d(l),l&&w(e)}}}function Al(n){let e,r;return e=new Vn({props:{client:n[4],$$slots:{default:[Sl]},$$scope:{ctx:n}}}),{c(){q(e.$$.fragment)},m(t,l){D(e,t,l),r=!0},p(t,[l]){const s={};l&79&&(s.$$scope={dirty:l,ctx:t}),e.$set(s)},i(t){r||(m(e.$$.fragment,t),r=!0)},o(t){g(e.$$.fragment,t),r=!1},d(t){M(e,t)}}}function jl(n,e,r){let t;J(n,Fe,u=>r(3,t=u));let{hidden:l}=e,{layout:s}=e,{lazyFolders:i}=e,{options:a}=e;Gt("options",a);const o=new Bn;return n.$$set=u=>{"hidden"in u&&r(0,l=u.hidden),"layout"in u&&r(1,s=u.layout),"lazyFolders"in u&&r(2,i=u.lazyFolders),"options"in u&&r(5,a=u.options)},[l,s,i,t,o,a]}class Ql extends N{constructor(e){super(),Q(this,e,jl,Al,A,{hidden:0,layout:1,lazyFolders:2,options:5})}}function Nl(n,e){const r=e||new URLSearchParams;return Object.keys(n).filter(t=>n[t]!==void 0).forEach(t=>r.set(t,n[t])),r}function de(n,e,r){const t=ne({},r);let l=new URL((n.startsWith("/")?window.location.origin:"")+n);return l.pathname=(l.pathname==="/"?"":l.pathname)+e,t.credentials="include",t.headers=ne({},t.headers),t.headers.Accept="application/json",t.json&&(t.body=JSON.stringify(t.json),t.headers["Content-Type"]="application/json"),t.query&&Nl(t.query,l.searchParams),t.params&&Object.keys(t.params).forEach(s=>l.pathname=l.pathname.replace(`%7B${s}%7D`,t.params[s])),fetch(l.toString(),t).then(s=>{if(s.status===ge.NoContent)return null;if(s.status>=ge.OK&&s.status<ge.MultipleChoices)return s.json();throw s.json().then(i=>{i!=null&&i.message?_e(i.message,"danger"):_e(U("serverError"),"danger")}).catch(()=>_e(U("serverError"),"danger")),s})}const Il={endpoint:"",readOnly:!1,httpHeaders:{},getFolders(n){var e;return de(this.endpoint,"/folders",{query:{parent:(e=n==null?void 0:n.id)==null?void 0:e.toString()},headers:this.httpHeaders})},createFolder(n){return de(this.endpoint,"/folders",{method:"post",headers:this.httpHeaders,json:n})},deleteFolder(n){return de(this.endpoint,"/folders/{id}",{method:"delete",headers:this.httpHeaders,params:{id:n.id.toString()}})},getFiles(n){return de(this.endpoint,"/files",{headers:this.httpHeaders,query:{folder:n!=null&&n.id?n.id.toString():void 0}})},uploadFile(n,e){const r=new FormData;return r.set("file",n),e!=null&&e.id&&r.set("folder",e.id.toString()),de(this.endpoint,"/files",{method:"post",headers:this.httpHeaders,body:r})},deleteFile(n){return de(this.endpoint,"/files/{id}",{method:"delete",headers:this.httpHeaders,params:{id:n.id.toString()}})}},nt=class{constructor(n,e={}){X(this,"fm",null),X(this,"options"),this.element=n,this.options=ne(ne({},Il),e)}static get observedAttributes(){return["hidden","endpoint"]}connectedCallback(){this.element.style.setProperty("display","block");const n=this.element.getAttribute("endpoint");if(n&&(this.options.endpoint=n),this.options.readOnly=this.element.hasAttribute("readonly"),!this.options.endpoint&&!this.options.getFiles)throw new Error("You must define an endpoint for this custom element");Jn(document.documentElement.getAttribute("lang")||"en"),this.fm=new Ql({target:this.element,props:{hidden:this.element.hidden,layout:this.element.getAttribute("layout")||"grid",lazyFolders:this.element.hasAttribute("lazy-folders"),options:this.options}})}attributeChangedCallback(n,e,r){n==="hidden"&&this.fm&&this.fm.$set({hidden:r!==null}),n==="endpoint"&&(this.options.endpoint=r)}disconnectedCallback(){var n;(n=this==null?void 0:this.fm)==null||n.$destroy()}static register(n="file-manager",e){if(!this.registered.has(n)){class r extends HTMLElement{constructor(){super(),X(this,"decorated"),this.decorated=new nt(this,e)}static get observedAttributes(){return nt.observedAttributes}connectedCallback(){return this.decorated.connectedCallback()}attributeChangedCallback(l,s,i){return this.decorated.attributeChangedCallback(l,s,i)}}customElements.define(n,r),this.registered.set(n,!0)}}};let un=nt;X(un,"registered",new Map);class Bl extends HTMLElement{connectedCallback(){this.filemanager=this.querySelector("file-manager"),this.imageManagerButton=this.querySelector("button#image-manager"),this.fileInput=this.querySelector('input[name$="[filename]"]'),this.altInput=this.querySelector('input[name$="[alt]"]'),this.filemanager&&this.imageManagerButton&&this.fileInput&&(un.register(),this.imageManagerButton.addEventListener("click",()=>{this.filemanager.removeAttribute("hidden")}),this.querySelector("button#remove").addEventListener("click",()=>{this.changeValue(""),this.altInput&&(this.altInput.value="")}),this.filemanager.addEventListener("close",()=>{this.filemanager.setAttribute("hidden",!0)}),this.filemanager.addEventListener("selectfile",e=>{this.changeValue(e.detail.url),this.changePreview(e.detail.thumbnail),this.filemanager.setAttribute("hidden",!0)}),this.changeValue(this.fileInput.value),this.changePreview(this.fileInput.value?`/files/${this.fileInput.value}`:null))}changeValue(e){this.fileInput.value=e}changePreview(e){e?this.querySelector(".image--preview").innerHTML=`<a href="${e}" class="editor__image--preview-image" style="background-image: url('${e}');background-size: contain"><span class="sr-only">Preview the image</span></a>`:this.querySelector(".image--preview").innerHTML=""}disconnectedCallback(){}}window.customElements.define("image-manager",Bl);
