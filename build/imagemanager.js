var un=Object.defineProperty,cn=Object.defineProperties,fn=Object.getOwnPropertyDescriptors,mt=Object.getOwnPropertySymbols,dn=Object.prototype.hasOwnProperty,hn=Object.prototype.propertyIsEnumerable,Te=(n,e,r)=>e in n?un(n,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[e]=r,T=(n,e)=>{for(var r in e||(e={}))dn.call(e,r)&&Te(n,r,e[r]);if(mt)for(var r of mt(e))hn.call(e,r)&&Te(n,r,e[r]);return n},ke=(n,e)=>cn(n,fn(e)),Y=(n,e,r)=>(Te(n,typeof e!="symbol"?e+"":e,r),r);function M(){}const mn=n=>n;function x(n,e){for(const r in e)n[r]=e[r];return n}function Bt(n){return n()}function pt(){return Object.create(null)}function G(n){n.forEach(Bt)}function se(n){return typeof n=="function"}function A(n,e){return n!=n?e==e:n!==e||n&&typeof n=="object"||typeof n=="function"}let Ee;function Se(n,e){return Ee||(Ee=document.createElement("a")),Ee.href=e,n===Ee.href}function pn(n){return Object.keys(n).length===0}function It(n,...e){if(n==null)return M;const r=n.subscribe(...e);return r.unsubscribe?()=>r.unsubscribe():r}function gn(n){let e;return It(n,r=>e=r)(),e}function J(n,e,r){n.$$.on_destroy.push(It(e,r))}function Ie(n,e,r,t){if(n){const l=Pt(n,e,r,t);return n[0](l)}}function Pt(n,e,r,t){return n[1]&&t?x(r.ctx.slice(),n[1](t(e))):r.ctx}function Pe(n,e,r,t){if(n[2]&&t){const l=n[2](t(r));if(e.dirty===void 0)return l;if(typeof l=="object"){const s=[],i=Math.max(e.dirty.length,l.length);for(let a=0;a<i;a+=1)s[a]=e.dirty[a]|l[a];return s}return e.dirty|l}return e.dirty}function Re(n,e,r,t,l,s){if(l){const i=Pt(e,r,t,s);n.p(i,l)}}function Ve(n){if(n.ctx.length>32){const e=[],r=n.ctx.length/32;for(let t=0;t<r;t++)e[t]=-1;return e}return-1}function pe(n){const e={};for(const r in n)r[0]!=="$"&&(e[r]=n[r]);return e}function Ae(n){return n??""}function Rt(n,e,r){return n.set(r),e}function ee(n){return n&&se(n.destroy)?n.destroy:M}const Vt=typeof window<"u";let _n=Vt?()=>window.performance.now():()=>Date.now(),rt=Vt?n=>requestAnimationFrame(n):M;const de=new Set;function Zt(n){de.forEach(e=>{e.c(n)||(de.delete(e),e.f())}),de.size!==0&&rt(Zt)}function vn(n){let e;return de.size===0&&rt(Zt),{promise:new Promise(r=>{de.add(e={c:n,f:r})}),abort(){de.delete(e)}}}function d(n,e){n.appendChild(e)}function Kt(n){if(!n)return document;const e=n.getRootNode?n.getRootNode():n.ownerDocument;return e&&e.host?e:n.ownerDocument}function bn(n){const e=v("style");return yn(Kt(n),e),e.sheet}function yn(n,e){d(n.head||n,e)}function C(n,e,r){n.insertBefore(e,r||null)}function w(n){n.parentNode.removeChild(n)}function Fe(n,e){for(let r=0;r<n.length;r+=1)n[r]&&n[r].d(e)}function v(n){return document.createElement(n)}function j(n){return document.createElementNS("http://www.w3.org/2000/svg",n)}function te(n){return document.createTextNode(n)}function O(){return te(" ")}function ue(){return te("")}function V(n,e,r,t){return n.addEventListener(e,r,t),()=>n.removeEventListener(e,r,t)}function ae(n){return function(e){return e.preventDefault(),n.call(this,e)}}function lt(n){return function(e){return e.stopPropagation(),n.call(this,e)}}function c(n,e,r){r==null?n.removeAttribute(e):n.getAttribute(e)!==r&&n.setAttribute(e,r)}function gt(n,e){const r=Object.getOwnPropertyDescriptors(n.__proto__);for(const t in e)e[t]==null?n.removeAttribute(t):t==="style"?n.style.cssText=e[t]:t==="__value"?n.value=n[t]=e[t]:r[t]&&r[t].set?n[t]=e[t]:c(n,t,e[t])}function _t(n,e){for(const r in e)c(n,r,e[r])}function $n(n){return Array.from(n.childNodes)}function ge(n,e){e=""+e,n.wholeText!==e&&(n.data=e)}function vt(n,e){n.value=e??""}function W(n,e,r){n.classList[r?"add":"remove"](e)}function Ht(n,e,r=!1){const t=document.createEvent("CustomEvent");return t.initCustomEvent(n,r,!1,e),t}const je=new Map;let Qe=0;function wn(n){let e=5381,r=n.length;for(;r--;)e=(e<<5)-e^n.charCodeAt(r);return e>>>0}function kn(n,e){const r={stylesheet:bn(e),rules:{}};return je.set(n,r),r}function bt(n,e,r,t,l,s,i,a=0){const o=16.666/t;let u=`{
`;for(let p=0;p<=1;p+=o){const $=e+(r-e)*s(p);u+=p*100+`%{${i($,1-$)}}
`}const f=u+`100% {${i(r,1-r)}}
}`,h=`__svelte_${wn(f)}_${a}`,g=Kt(n),{stylesheet:y,rules:z}=je.get(g)||kn(g,n);z[h]||(z[h]=!0,y.insertRule(`@keyframes ${h} ${f}`,y.cssRules.length));const b=n.style.animation||"";return n.style.animation=`${b?`${b}, `:""}${h} ${t}ms linear ${l}ms 1 both`,Qe+=1,h}function Cn(n,e){const r=(n.style.animation||"").split(", "),t=r.filter(e?s=>s.indexOf(e)<0:s=>s.indexOf("__svelte")===-1),l=r.length-t.length;l&&(n.style.animation=t.join(", "),Qe-=l,Qe||zn())}function zn(){rt(()=>{Qe||(je.forEach(n=>{const{stylesheet:e}=n;let r=e.cssRules.length;for(;r--;)e.deleteRule(r);n.rules={}}),je.clear())})}let Ce;function we(n){Ce=n}function it(){if(!Ce)throw new Error("Function called outside component initialization");return Ce}function Ln(){const n=it();return(e,r)=>{const t=n.$$.callbacks[e];if(t){const l=Ht(e,r);t.slice().forEach(s=>{s.call(n,l)})}}}function Ut(n,e){it().$$.context.set(n,e)}function Gt(n){return it().$$.context.get(n)}const $e=[],Ne=[],Me=[],yt=[],Fn=Promise.resolve();let xe=!1;function En(){xe||(xe=!0,Fn.then(Jt))}function oe(n){Me.push(n)}const Ge=new Set;let De=0;function Jt(){const n=Ce;do{for(;De<$e.length;){const e=$e[De];De++,we(e),Dn(e.$$)}for(we(null),$e.length=0,De=0;Ne.length;)Ne.pop()();for(let e=0;e<Me.length;e+=1){const r=Me[e];Ge.has(r)||(Ge.add(r),r())}Me.length=0}while($e.length);for(;yt.length;)yt.pop()();xe=!1,Ge.clear(),we(n)}function Dn(n){if(n.fragment!==null){n.update(),G(n.before_update);const e=n.dirty;n.dirty=[-1],n.fragment&&n.fragment.p(n.ctx,e),n.after_update.forEach(oe)}}let ye;function Mn(){return ye||(ye=Promise.resolve(),ye.then(()=>{ye=null})),ye}function Je(n,e,r){n.dispatchEvent(Ht(`${e?"intro":"outro"}${r}`))}const Oe=new Set;let X;function Z(){X={r:0,c:[],p:X}}function K(){X.r||G(X.c),X=X.p}function m(n,e){n&&n.i&&(Oe.delete(n),n.i(e))}function _(n,e,r,t){if(n&&n.o){if(Oe.has(n))return;Oe.add(n),X.c.push(()=>{Oe.delete(n),t&&(r&&n.d(1),t())}),n.o(e)}}const On={duration:0};function le(n,e,r,t){let l=e(n,r),s=t?0:1,i=null,a=null,o=null;function u(){o&&Cn(n,o)}function f(g,y){const z=g.b-s;return y*=Math.abs(z),{a:s,b:g.b,d:z,duration:y,start:g.start,end:g.start+y,group:g.group}}function h(g){const{delay:y=0,duration:z=300,easing:b=mn,tick:p=M,css:$}=l||On,I={start:_n()+y,b:g};g||(I.group=X,X.r+=1),i||a?a=I:($&&(u(),o=bt(n,s,g,z,y,b,$)),g&&p(0,1),i=f(I,z),oe(()=>Je(n,g,"start")),vn(k=>{if(a&&k>a.start&&(i=f(a,z),a=null,Je(n,i.b,"start"),$&&(u(),o=bt(n,s,i.b,i.duration,0,b,l.css))),i){if(k>=i.end)p(s=i.b,1-s),Je(n,i.b,"end"),a||(i.b?u():--i.group.r||G(i.group.c)),i=null;else if(k>=i.start){const L=k-i.start;s=i.a+i.d*b(L/i.duration),p(s,1-s)}}return!!(i||a)}))}return{run(g){se(l)?Mn().then(()=>{l=l(),h(g)}):h(g)},end(){u(),i=a=null}}}function Wt(n,e){const r={},t={},l={$$scope:1};let s=n.length;for(;s--;){const i=n[s],a=e[s];if(a){for(const o in i)o in a||(t[o]=1);for(const o in a)l[o]||(r[o]=a[o],l[o]=1);n[s]=a}else for(const o in i)l[o]=1}for(const i in t)i in r||(r[i]=void 0);return r}function q(n){n&&n.c()}function E(n,e,r,t){const{fragment:l,on_mount:s,on_destroy:i,after_update:a}=n.$$;l&&l.m(e,r),t||oe(()=>{const o=s.map(Bt).filter(se);i?i.push(...o):G(o),n.$$.on_mount=[]}),a.forEach(oe)}function D(n,e){const r=n.$$;r.fragment!==null&&(G(r.on_destroy),r.fragment&&r.fragment.d(e),r.on_destroy=r.fragment=null,r.ctx=[])}function qn(n,e){n.$$.dirty[0]===-1&&($e.push(n),En(),n.$$.dirty.fill(0)),n.$$.dirty[e/31|0]|=1<<e%31}function Q(n,e,r,t,l,s,i,a=[-1]){const o=Ce;we(n);const u=n.$$={fragment:null,ctx:null,props:s,update:M,not_equal:l,bound:pt(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(o?o.$$.context:[])),callbacks:pt(),dirty:a,skip_bound:!1,root:e.target||o.$$.root};i&&i(u.root);let f=!1;if(u.ctx=r?r(n,e.props||{},(h,g,...y)=>{const z=y.length?y[0]:g;return u.ctx&&l(u.ctx[h],u.ctx[h]=z)&&(!u.skip_bound&&u.bound[h]&&u.bound[h](z),f&&qn(n,h)),g}):[],u.update(),f=!0,G(u.before_update),u.fragment=t?t(u.ctx):!1,e.target){if(e.hydrate){const h=$n(e.target);u.fragment&&u.fragment.l(h),h.forEach(w)}else u.fragment&&u.fragment.c();e.intro&&m(n.$$.fragment),E(n,e.target,e.anchor,e.customElement),Jt()}we(o)}class N{$destroy(){D(this,1),this.$destroy=M}$on(e,r){const t=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return t.push(r),()=>{const l=t.indexOf(r);l!==-1&&t.splice(l,1)}}$set(e){this.$$set&&!pn(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}function Yt(n,e="outclick"){const r=t=>{n.contains(t.target)||n.dispatchEvent(new CustomEvent(e,{bubbles:e!=="outclick"}))};return document.addEventListener("click",r,!0),{destroy(){document.removeEventListener("click",r,!0)}}}function Sn(n){const e=n-1;return e*e*e+1}function ie(n,{delay:e=0,duration:r=400,easing:t=Sn,x:l=0,y:s=0,opacity:i=0}={}){const a=getComputedStyle(n),o=+a.opacity,u=a.transform==="none"?"":a.transform,f=o*(1-i);return{delay:e,duration:r,easing:t,css:(h,g)=>`
			transform: ${u} translate(${(1-h)*l}px, ${(1-h)*s}px);
			opacity: ${o-f*g}`}}const ce=[];function _e(n,e=M){let r;const t=new Set;function l(a){if(A(n,a)&&(n=a,r)){const o=!ce.length;for(const u of t)u[1](),ce.push(u,n);if(o){for(let u=0;u<ce.length;u+=2)ce[u][0](ce[u+1]);ce.length=0}}}function s(a){l(a(n))}function i(a,o=M){const u=[a,o];return t.add(u),t.size===1&&(r=e(l)||M),a(n),()=>{t.delete(u),t.size===0&&(r(),r=null)}}return{set:l,update:s,subscribe:i}}function An(n){return typeof n=="object"&&typeof n.then=="function"}class jn{constructor(e,r){Y(this,"store"),Y(this,"getState",()=>gn(this.store)),Y(this,"setData",l=>{this.store.update(s=>ke(T({},s),{isLoading:!1,isSuccess:!0,data:typeof l=="function"?l(s.data):l}))}),Y(this,"getData",()=>this.getState().data);const t=()=>{if(this.getData())return;const l=e();An(l)?l.then(this.setData).catch(s=>{var i;(i=r.onError)==null||i.call(r),this.store.update(a=>ke(T({},a),{isLoading:!1,isSuccess:!1}))}):this.setData(l)};this.store=_e({isSuccess:!1,isLoading:!1,data:void 0,refetch:t}),r.enabled!==!1&&t()}}class Qn{constructor(){Y(this,"queries",new Map)}getQuery(e,r,t={}){return this.queries.has(e)||this.queries.set(e,new jn(r,t)),this.queries.get(e)}setQueryData(e,r){const t=this.queries.get(e);t&&t.setData(r)}getQueryData(e){var r;return(r=this.queries.get(e))==null?void 0:r.getData()}getQueryState(e){const r=this.queries.get(e);return r?r.getState():{data:void 0,isLoading:!1,isSuccess:!1,refetch:()=>{}}}}function et(n,e,r={}){return{subscribe:ve().getQuery(n,e,r).store.subscribe}}function Xt(n,e={}){const r=l=>(t.update(s=>ke(T({},s),{isLoading:!0})),n(l).then(s=>{var i;return(i=e.onSuccess)==null||i.call(e,s),s}).catch(s=>{var i;throw(i=e.onError)==null||i.call(e,s),s}).finally(()=>{t.update(s=>ke(T({},s),{isLoading:!1}))})),t=_e({isLoading:!1,mutate:l=>{r(l).catch(()=>null)},mutateAsync:r});return{subscribe:t.subscribe}}function Nn(n){let e;const r=n[2].default,t=Ie(r,n,n[1],null);return{c(){t&&t.c()},m(l,s){t&&t.m(l,s),e=!0},p(l,[s]){t&&t.p&&(!e||s&2)&&Re(t,r,l,l[1],e?Pe(r,l[1],s,null):Ve(l[1]),null)},i(l){e||(m(t,l),e=!0)},o(l){_(t,l),e=!1},d(l){t&&t.d(l)}}}function Bn(n,e,r){let{$$slots:t={},$$scope:l}=e,{client:s}=e;return Ut(Tt,s),n.$$set=i=>{"client"in i&&r(0,s=i.client),"$$scope"in i&&r(1,l=i.$$scope)},[s,l,t]}class In extends N{constructor(e){super(),Q(this,e,Bn,Nn,A,{client:0})}}const Tt=Symbol("queryClient");function ve(){return Gt(Tt)}function Pn(n){let e,r,t;return{c(){e=v("div"),c(e,"class",r=Ae(`loader ${n[1].class}`)+" svelte-1cyki07"),c(e,"style",t=`--size:${n[0]}px`)},m(l,s){C(l,e,s)},p(l,[s]){s&2&&r!==(r=Ae(`loader ${l[1].class}`)+" svelte-1cyki07")&&c(e,"class",r),s&1&&t!==(t=`--size:${l[0]}px`)&&c(e,"style",t)},i:M,o:M,d(l){l&&w(e)}}}function Rn(n,e,r){let{size:t=20}=e;return n.$$set=l=>{r(1,e=x(x({},e),pe(l))),"size"in l&&r(0,t=l.size)},e=pe(e),[t,e]}class Ze extends N{constructor(e){super(),Q(this,e,Rn,Pn,A,{size:0})}}function Vn(n){let e,r,t,l=[{width:"23"},{height:"23"},{fill:"none"},{xmlns:"http://www.w3.org/2000/svg"},n[0]],s={};for(let i=0;i<l.length;i+=1)s=x(s,l[i]);return{c(){e=j("svg"),r=j("path"),t=j("path"),c(r,"d","M22.7 10.578c-.289-.29-.72-.578-1.152-.578H5.715c-.575 0-1.151.289-1.295.867L.102 20.977C-.186 21.845.102 23 1.397 23H17.23c.575 0 1.151-.289 1.295-.867l4.318-10.11c.288-.434.144-1.012-.144-1.445z"),c(r,"fill","currentColor"),c(t,"d","M1.754 9.814c.73-1.587 2.338-2.598 4.092-2.598H19V4.33c0-.866-.585-1.443-1.462-1.443H9.354L6.869.433C6.577.144 6.285 0 5.846 0H1.462C.585 0 0 .577 0 1.443V14l1.754-4.186z"),c(t,"fill","currentColor"),_t(e,s)},m(i,a){C(i,e,a),d(e,r),d(e,t)},p(i,[a]){_t(e,s=Wt(l,[{width:"23"},{height:"23"},{fill:"none"},{xmlns:"http://www.w3.org/2000/svg"},a&1&&i[0]]))},i:M,o:M,d(i){i&&w(e)}}}function Zn(n,e,r){return n.$$set=t=>{r(0,e=x(x({},e),pe(t)))},e=pe(e),[e]}class xt extends N{constructor(e){super(),Q(this,e,Zn,Vn,A,{})}}var he=(n=>(n[n.OK=200]="OK",n[n.Created=201]="Created",n[n.MultipleChoices=300]="MultipleChoices",n[n.NoContent=204]="NoContent",n[n.UnprocessableEntity=422]="UnprocessableEntity",n[n.Forbidden=403]="Forbidden",n[n.NotFound=404]="NotFound",n[n.BadRequest=400]="BadRequest",n))(he||{}),Kn={delete:"Supprimer",deleteConfirm:"Voulez vous vraiment supprimer ce fichier ?",newFolderPlaceholder:"Nom du dossier",emptyTitle:"Ce dossier est vide",deleteFolder:"Supprimer le dossier",emptyDescription:"Déposer un fichier ici pour le téléverser",createFolder:"Créer un dossier",copy:"Copier le lien",size:"Taille",filename:"Nom",serverError:"Action impossible suite a une erreur serveur"};const st={delete:"Delete",deleteConfirm:"Do you really want to delete this file ?",newFolderPlaceholder:"Folder name",deleteFolder:"Delete this folder",emptyTitle:"This folder is empty",emptyDescription:"Drop a file here to upload it",createFolder:"New folder",copy:"Copy link",size:"Size",filename:"Name",serverError:"Server error"},$t={fr:Kn,en:st};let en=st;function H(n){return en[n]}function Hn(n){en=n in $t?$t[n]:st}const Be=_e([]),me=(n,e="success")=>{const r=Date.now();Be.update(t=>[{type:e,message:n,id:r},...t]),e==="success"&&window.setTimeout(()=>{Be.update(t=>t.filter(l=>l.id!==r))},2e3)},Un=n=>{Be.update(e=>e.filter(r=>r.id!==n))},ot=n=>`files/${n??""}`,ze=n=>`folders/${n??""}`,tn=_e(null),Le=tn,qe=_e(""),Gn=async(n,e,r)=>{const t=ot(r.folder),l=e.getQueryData(t);l&&e.setQueryData(t,s=>s?s.filter(i=>i.id!==r.id):[]);try{await n.deleteFile(r)}catch(s){(!(s instanceof Response)||s.status!==he.UnprocessableEntity)&&(me(H("serverError"),"danger"),console.error(s)),e.setQueryData(t,l)}},nn=async(n,e,r,t)=>{try{const l=await n.uploadFile(r,t),s=ot(t==null?void 0:t.id),i=e.getQueryState(s);i!=null&&i.data&&e.setQueryData(s,a=>a?[l,...a]:[l])}catch(l){(!(l instanceof Response)||l.status!==he.UnprocessableEntity)&&(me(H("serverError"),"danger"),console.error(l))}},Jn=()=>{const n=ve(),e=ne();return Xt(r=>e.createFolder(r),{onSuccess(r){const t=l=>{const s=ze(l),i=n.getQueryState(s);i!=null&&i.data&&n.setQueryData(s,a=>a?[r,...a]:[r])};t(r.parent),r.parent&&t(null)}})},Wn=()=>{const n=ve(),e=ne();return Xt(r=>e.deleteFolder(r).then(t=>r),{onSuccess:r=>{tn.update(()=>null);const t=l=>{const s=ze(l),i=n.getQueryState(s);i!=null&&i.data&&n.setQueryData(ze(l),a=>a?a.filter(o=>o.id!==r.id):[])};t(r.parent),t()}})},Yn=300,We=_e([]),Ye=new Map,tt={push(n){const e=setTimeout(()=>{We.update(r=>[n,...r])},Yn);Ye.set(n,e)},remove(n){const e=Ye.get(n);e!==void 0&&(clearTimeout(e),Ye.delete(n)),We.update(r=>r.filter(t=>t!==n))},subscribe:We.subscribe};function ne(){return Gt("options")}function Xe(n,e,r){return e.forEach(t=>{n.addEventListener(t,r)}),()=>{e.forEach(t=>{n.removeEventListener(t,r)})}}function rn(n){const e=Xe(n,["drag","dragstart","dragend","dragover","dragenter","dragleave","drop"],function(l){l.preventDefault(),l.stopPropagation()}),r=Xe(n,["dragover","dragenter"],function(){n.dispatchEvent(new CustomEvent("dropzoneover"))}),t=Xe(n,["dragleave","dragend","drop"],function(){n.dispatchEvent(new CustomEvent("dropzoneleave"))});return{destroy(){e(),r(),t()}}}function Xn(n){let e,r,t;return{c(){e=j("svg"),r=j("path"),t=j("path"),c(r,"stroke","currentColor"),c(r,"stroke-linecap","round"),c(r,"stroke-width","2"),c(r,"d","M12 12H8m4-4v4-4Zm0 4v4-4Zm0 0h4-4Z"),c(t,"stroke","currentColor"),c(t,"stroke-width","2"),c(t,"d","M12 22a10 10 0 1 0 0-20 10 10 0 0 0 0 20Z"),c(e,"xmlns","http://www.w3.org/2000/svg"),c(e,"fill","none"),c(e,"width",n[0]),c(e,"height",n[0]),c(e,"viewBox","0 0 24 24")},m(l,s){C(l,e,s),d(e,r),d(e,t)},p(l,[s]){s&1&&c(e,"width",l[0]),s&1&&c(e,"height",l[0])},i:M,o:M,d(l){l&&w(e)}}}function Tn(n,e,r){let{size:t=24}=e;return n.$$set=l=>{"size"in l&&r(0,t=l.size)},[t]}class xn extends N{constructor(e){super(),Q(this,e,Tn,Xn,A,{size:0})}}function er(n){return n.focus(),{}}function tr(n){let e,r;return{c(){e=j("svg"),r=j("path"),c(r,"fill","currentColor"),c(r,"fill-rule","evenodd"),c(r,"d","M0 8a1 1 0 0 1 1-1h11.58L8.3 2.7a1 1 0 1 1 1.42-1.4l6 6a1 1 0 0 1 0 1.4l-6 6a1 1 0 0 1-1.42-1.4L12.6 9H1a1 1 0 0 1-1-1Z"),c(r,"clip-rule","evenodd"),c(e,"xmlns","http://www.w3.org/2000/svg"),c(e,"fill","none"),c(e,"viewBox","0 0 16 16"),c(e,"width",n[0]),c(e,"height",n[0])},m(t,l){C(t,e,l),d(e,r)},p(t,[l]){l&1&&c(e,"width",t[0]),l&1&&c(e,"height",t[0])},i:M,o:M,d(t){t&&w(e)}}}function nr(n,e,r){let{size:t=16}=e;return n.$$set=l=>{"size"in l&&r(0,t=l.size)},[t]}class rr extends N{constructor(e){super(),Q(this,e,nr,tr,A,{size:0})}}function lr(n){let e,r;const t=n[2].default,l=Ie(t,n,n[1],null);let s=[n[0]],i={};for(let a=0;a<s.length;a+=1)i=x(i,s[a]);return{c(){e=v("button"),l&&l.c(),gt(e,i),W(e,"svelte-ms51de",!0)},m(a,o){C(a,e,o),l&&l.m(e,null),e.autofocus&&e.focus(),r=!0},p(a,[o]){l&&l.p&&(!r||o&2)&&Re(l,t,a,a[1],r?Pe(t,a[1],o,null):Ve(a[1]),null),gt(e,i=Wt(s,[o&1&&a[0]])),W(e,"svelte-ms51de",!0)},i(a){r||(m(l,a),r=!0)},o(a){_(l,a),r=!1},d(a){a&&w(e),l&&l.d(a)}}}function ir(n,e,r){let{$$slots:t={},$$scope:l}=e;return n.$$set=s=>{r(0,e=x(x({},e),pe(s))),"$$scope"in s&&r(1,l=s.$$scope)},e=pe(e),[e,l,t]}class sr extends N{constructor(e){super(),Q(this,e,ir,lr,A,{})}}function or(n){let e,r;return e=new rr({props:{size:12}}),{c(){q(e.$$.fragment)},m(t,l){E(e,t,l),r=!0},i(t){r||(m(e.$$.fragment,t),r=!0)},o(t){_(e.$$.fragment,t),r=!1},d(t){D(e,t)}}}function ar(n){let e,r;return e=new Ze({props:{size:12}}),{c(){q(e.$$.fragment)},m(t,l){E(e,t,l),r=!0},i(t){r||(m(e.$$.fragment,t),r=!0)},o(t){_(e.$$.fragment,t),r=!1},d(t){D(e,t)}}}function ur(n){let e,r,t,l;const s=[ar,or],i=[];function a(o,u){return o[0].isLoading?0:1}return e=a(n),r=i[e]=s[e](n),{c(){r.c(),t=ue()},m(o,u){i[e].m(o,u),C(o,t,u),l=!0},p(o,u){let f=e;e=a(o),e!==f&&(Z(),_(i[f],1,1,()=>{i[f]=null}),K(),r=i[e],r||(r=i[e]=s[e](o),r.c()),m(r,1),r.m(t.parentNode,t))},i(o){l||(m(r),l=!0)},o(o){_(r),l=!1},d(o){i[e].d(o),o&&w(t)}}}function cr(n){let e,r,t,l,s,i,a,o,u,f;return r=new xt({}),a=new sr({props:{disabled:n[0].isLoading,$$slots:{default:[ur]},$$scope:{ctx:n}}}),{c(){e=v("form"),q(r.$$.fragment),t=O(),l=v("input"),i=O(),q(a.$$.fragment),c(l,"type","text"),c(l,"placeholder",H("newFolderPlaceholder")),c(l,"name","name"),l.required=!0,l.disabled=s=n[0].isLoading,c(l,"class","svelte-bopbht"),c(e,"action",""),c(e,"class","fm-folder-form svelte-bopbht")},m(h,g){C(h,e,g),E(r,e,null),d(e,t),d(e,l),d(e,i),E(a,e,null),o=!0,u||(f=[ee(er.call(null,l)),V(e,"submit",ae(n[2])),ee(Yt.call(null,e)),V(e,"outclick",n[3])],u=!0)},p(h,[g]){(!o||g&1&&s!==(s=h[0].isLoading))&&(l.disabled=s);const y={};g&1&&(y.disabled=h[0].isLoading),g&65&&(y.$$scope={dirty:g,ctx:h}),a.$set(y)},i(h){o||(m(r.$$.fragment,h),m(a.$$.fragment,h),o=!0)},o(h){_(r.$$.fragment,h),_(a.$$.fragment,h),o=!1},d(h){h&&w(e),D(r),D(a),u=!1,G(f)}}}function fr(n,e,r){let t,{parent:l}=e;const s=Jn();J(n,s,u=>r(0,t=u));const i=async u=>{const f=new FormData(u.currentTarget).get("name").toString();await t.mutateAsync({name:f,parent:l==null?void 0:l.id}),o("submit")},a=()=>{o("cancel")},o=Ln();return n.$$set=u=>{"parent"in u&&r(4,l=u.parent)},[t,s,i,a,l]}class dr extends N{constructor(e){super(),Q(this,e,fr,cr,A,{parent:4})}}function hr(n){const e=n.map(t=>ke(T({},t),{children:[]})),r=e.reduce((t,l)=>t.set(l.id,l),new Map);for(const t of e){const l=r.get(t.parent);t.parent&&l&&(l.children=l.children?[...l.children,t]:[t])}return e}function Ke(n,e){let r=null;const t=()=>{if(r)return;const l=n.getBoundingClientRect();r=document.createElement("div"),r.classList.add("fm-tooltip"),r.innerText=e,n.closest(".fm-root").appendChild(r),r.style.setProperty("transform",`translate(calc(${l.left+l.width/2}px - 50%), calc(${l.top-4}px - 100%))`),r.animate([{opacity:0},{opacity:1}],{duration:200,easing:"ease-in-out"}),n.addEventListener("pointerleave",()=>{r&&(r.animate([{opacity:1},{opacity:0}],{duration:200,easing:"ease-in-out"}),window.setTimeout(()=>{r==null||r.remove(),r=null},200))},{once:!0})};return n.addEventListener("pointerenter",t),{destroy(){r==null||r.remove(),n.removeEventListener("pointerenter",t)}}}function mr(n){let e,r;return e=new xt({props:{class:"folder-icon"}}),{c(){q(e.$$.fragment)},m(t,l){E(e,t,l),r=!0},i(t){r||(m(e.$$.fragment,t),r=!0)},o(t){_(e.$$.fragment,t),r=!1},d(t){D(e,t)}}}function pr(n){let e,r;return e=new Ze({props:{size:20,class:"folder-loader"}}),{c(){q(e.$$.fragment)},m(t,l){E(e,t,l),r=!0},i(t){r||(m(e.$$.fragment,t),r=!0)},o(t){_(e.$$.fragment,t),r=!1},d(t){D(e,t)}}}function gr(n){let e,r,t,l,s;return r=new xn({props:{size:16}}),{c(){e=v("button"),q(r.$$.fragment),c(e,"class","fm-new-folder svelte-1nyuu78")},m(i,a){C(i,e,a),E(r,e,null),t=!0,l||(s=[V(e,"click",ae(n[12])),ee(Ke.call(null,e,H("createFolder")))],l=!0)},p:M,i(i){t||(m(r.$$.fragment,i),t=!0)},o(i){_(r.$$.fragment,i),t=!1},d(i){i&&w(e),D(r),l=!1,G(s)}}}function wt(n){let e,r;return e=new dr({props:{parent:n[0]}}),e.$on("submit",n[13]),e.$on("cancel",n[13]),{c(){q(e.$$.fragment)},m(t,l){E(e,t,l),r=!0},p(t,l){const s={};l&1&&(s.parent=t[0]),e.$set(s)},i(t){r||(m(e.$$.fragment,t),r=!0)},o(t){_(e.$$.fragment,t),r=!1},d(t){D(e,t)}}}function _r(n){let e,r;return e=new at({props:{folders:n[6],lazyLoad:n[1]}}),{c(){q(e.$$.fragment)},m(t,l){E(e,t,l),r=!0},p(t,l){const s={};l&64&&(s.folders=t[6]),l&2&&(s.lazyLoad=t[1]),e.$set(s)},i(t){r||(m(e.$$.fragment,t),r=!0)},o(t){_(e.$$.fragment,t),r=!1},d(t){D(e,t)}}}function vr(n){var e;let r,t;return r=new at({props:{folders:(e=n[0])==null?void 0:e.children,lazyLoad:n[1]}}),{c(){q(r.$$.fragment)},m(l,s){E(r,l,s),t=!0},p(l,s){var i;const a={};s&1&&(a.folders=(i=l[0])==null?void 0:i.children),s&2&&(a.lazyLoad=l[1]),r.$set(a)},i(l){t||(m(r.$$.fragment,l),t=!0)},o(l){_(r.$$.fragment,l),t=!1},d(l){D(r,l)}}}function br(n){var e,r;let t,l,s,i,a,o,u,f=((r=(e=n[0])==null?void 0:e.name)!=null?r:"/")+"",h,g,y,z,b,p,$,I,k;const L=[pr,mr],F=[];function R(S,U){return S[2].isLoading?0:1}i=R(n),a=F[i]=L[i](n);let P=!n[8].readOnly&&gr(n),B=n[4]&&wt(n);const ut=[vr,_r],re=[];function ct(S,U){var be;return(be=S[0])!=null&&be.children&&S[5]?0:S[6]&&S[5]?1:-1}return~(b=ct(n))&&(p=re[b]=ut[b](n)),{c(){var S,U;t=v("li"),l=v("span"),s=v("span"),a.c(),o=O(),u=v("span"),h=te(f),g=O(),P&&P.c(),y=O(),B&&B.c(),z=O(),p&&p.c(),c(u,"class","fm-folder-name svelte-1nyuu78"),c(s,"class","fm-folder svelte-1nyuu78"),c(l,"class","fm-folder-wrapper svelte-1nyuu78"),W(l,"active",((S=n[0])==null?void 0:S.id)===((U=n[7])==null?void 0:U.id)||n[3])},m(S,U){C(S,t,U),d(t,l),d(l,s),F[i].m(s,null),d(s,o),d(s,u),d(u,h),d(l,g),P&&P.m(l,null),d(t,y),B&&B.m(t,null),d(t,z),~b&&re[b].m(t,null),$=!0,I||(k=[ee(rn.call(null,s)),V(s,"click",ae(n[14])),V(s,"dropzoneover",n[9]),V(s,"dropzoneleave",n[10]),V(s,"drop",n[11])],I=!0)},p(S,[U]){var be,ft,dt,ht;let He=i;i=R(S),i!==He&&(Z(),_(F[He],1,1,()=>{F[He]=null}),K(),a=F[i],a||(a=F[i]=L[i](S),a.c()),m(a,1),a.m(s,o)),(!$||U&1)&&f!==(f=((ft=(be=S[0])==null?void 0:be.name)!=null?ft:"/")+"")&&ge(h,f),S[8].readOnly||P.p(S,U),U&137&&W(l,"active",((dt=S[0])==null?void 0:dt.id)===((ht=S[7])==null?void 0:ht.id)||S[3]),S[4]?B?(B.p(S,U),U&16&&m(B,1)):(B=wt(S),B.c(),m(B,1),B.m(t,z)):B&&(Z(),_(B,1,1,()=>{B=null}),K());let Ue=b;b=ct(S),b===Ue?~b&&re[b].p(S,U):(p&&(Z(),_(re[Ue],1,1,()=>{re[Ue]=null}),K()),~b?(p=re[b],p?p.p(S,U):(p=re[b]=ut[b](S),p.c()),m(p,1),p.m(t,null)):p=null)},i(S){$||(m(a),m(P),m(B),m(p),$=!0)},o(S){_(a),_(P),_(B),_(p),$=!1},d(S){S&&w(t),F[i].d(),P&&P.d(),B&&B.d(),~b&&re[b].d(),I=!1,G(k)}}}function yr(n,e,r){let t,l;J(n,Le,L=>r(7,l=L));const s=ve();let{folder:i}=e,{lazyLoad:a}=e,o=!1,u=!1,f=!(i!=null&&i.id);const h=ne(),g=()=>{h.readOnly||r(3,o=!0)},y=()=>{h.readOnly||r(3,o=!1)},z=L=>{h.readOnly&&L.preventDefault(),Array.from(L.dataTransfer.files).forEach(F=>nn(h,s,F,i))},b=()=>{r(4,u=!0),r(5,f=!0),!t.isSuccess&&(i==null?void 0:i.children)===void 0&&t.refetch()},p=()=>{r(4,u=!1)},$=()=>{if(f&&l===i){r(5,f=!1);return}r(5,f=!0),Rt(Le,l=i,l),(i==null?void 0:i.children)===void 0&&t.refetch()},I=et(ze(i==null?void 0:i.id),()=>h.getFolders(i!=null&&i.id?i:void 0),{enabled:!(i!=null&&i.id)});J(n,I,L=>r(2,t=L));let k=null;return n.$$set=L=>{"folder"in L&&r(0,i=L.folder),"lazyLoad"in L&&r(1,a=L.lazyLoad)},n.$$.update=()=>{n.$$.dirty&7&&t.isSuccess&&r(6,k=(a?t.data:hr(t.data)).filter(L=>{var F,R;return((F=L.parent)!=null?F:null)===((R=i==null?void 0:i.id)!=null?R:null)}))},[i,a,t,o,u,f,k,l,h,g,y,z,b,p,$,I]}class $r extends N{constructor(e){super(),Q(this,e,yr,br,A,{folder:0,lazyLoad:1})}}function kt(n,e,r){const t=n.slice();return t[2]=e[r],t}function Ct(n){let e,r;return e=new $r({props:{folder:n[2],lazyLoad:n[1]}}),{c(){q(e.$$.fragment)},m(t,l){E(e,t,l),r=!0},p(t,l){const s={};l&1&&(s.folder=t[2]),l&2&&(s.lazyLoad=t[1]),e.$set(s)},i(t){r||(m(e.$$.fragment,t),r=!0)},o(t){_(e.$$.fragment,t),r=!1},d(t){D(e,t)}}}function wr(n){let e,r,t=n[0],l=[];for(let i=0;i<t.length;i+=1)l[i]=Ct(kt(n,t,i));const s=i=>_(l[i],1,1,()=>{l[i]=null});return{c(){e=v("ul");for(let i=0;i<l.length;i+=1)l[i].c();c(e,"class","fm-folders svelte-1spuanm")},m(i,a){C(i,e,a);for(let o=0;o<l.length;o+=1)l[o].m(e,null);r=!0},p(i,[a]){if(a&3){t=i[0];let o;for(o=0;o<t.length;o+=1){const u=kt(i,t,o);l[o]?(l[o].p(u,a),m(l[o],1)):(l[o]=Ct(u),l[o].c(),m(l[o],1),l[o].m(e,null))}for(Z(),o=t.length;o<l.length;o+=1)s(o);K()}},i(i){if(!r){for(let a=0;a<t.length;a+=1)m(l[a]);r=!0}},o(i){l=l.filter(Boolean);for(let a=0;a<l.length;a+=1)_(l[a]);r=!1},d(i){i&&w(e),Fe(l,i)}}}function kr(n,e,r){let{folders:t}=e,{lazyLoad:l}=e;return n.$$set=s=>{"folders"in s&&r(0,t=s.folders),"lazyLoad"in s&&r(1,l=s.lazyLoad)},[t,l]}class at extends N{constructor(e){super(),Q(this,e,kr,wr,A,{folders:0,lazyLoad:1})}}function Cr(n){let e,r,t;return{c(){e=j("svg"),r=j("path"),t=j("path"),c(r,"d","M0 6.417a6.424 6.424 0 006.417 6.416 6.424 6.424 0 006.416-6.416A6.424 6.424 0 006.417 0 6.424 6.424 0 000 6.417zm1.833 0a4.589 4.589 0 014.584-4.584A4.589 4.589 0 0111 6.417 4.589 4.589 0 016.417 11a4.589 4.589 0 01-4.584-4.583z"),c(r,"fill","currentColor"),c(t,"d","M13.75 12.543L11.707 10.5c-.35.452-.755.856-1.207 1.207l2.043 2.043a.851.851 0 001.207 0 .853.853 0 000-1.207z"),c(t,"fill","currentColor"),c(e,"width","14"),c(e,"height","14"),c(e,"fill","none"),c(e,"xmlns","http://www.w3.org/2000/svg")},m(l,s){C(l,e,s),d(e,r),d(e,t)},p:M,i:M,o:M,d(l){l&&w(e)}}}class zr extends N{constructor(e){super(),Q(this,e,null,Cr,A,{})}}function Lr(n){let e,r,t,l,s,i,a,o;return s=new zr({}),{c(){e=v("form"),r=v("input"),t=O(),l=v("button"),q(s.$$.fragment),c(r,"type","search"),c(r,"name","search"),c(r,"placeholder","e.g. image.png"),c(r,"class","svelte-15kvubs"),c(l,"title","Search"),c(l,"class","svelte-15kvubs"),c(e,"class","search svelte-15kvubs")},m(u,f){C(u,e,f),d(e,r),vt(r,n[0]),d(e,t),d(e,l),E(s,l,null),i=!0,a||(o=V(r,"input",n[1]),a=!0)},p(u,[f]){f&1&&vt(r,u[0])},i(u){i||(m(s.$$.fragment,u),i=!0)},o(u){_(s.$$.fragment,u),i=!1},d(u){u&&w(e),D(s),a=!1,o()}}}function Fr(n,e,r){let t;J(n,qe,s=>r(0,t=s)),Le.subscribe(()=>{Rt(qe,t="",t)});function l(){t=this.value,qe.set(t)}return[t,l]}class Er extends N{constructor(e){super(),Q(this,e,Fr,Lr,A,{})}}function Dr(n){let e,r,t,l,s;return r=new Er({}),l=new at({props:{folders:[null],lazyLoad:n[0]}}),{c(){e=v("aside"),q(r.$$.fragment),t=O(),q(l.$$.fragment),c(e,"class","fm-sidebar svelte-jz8ywq")},m(i,a){C(i,e,a),E(r,e,null),d(e,t),E(l,e,null),s=!0},p(i,[a]){const o={};a&1&&(o.lazyLoad=i[0]),l.$set(o)},i(i){s||(m(r.$$.fragment,i),m(l.$$.fragment,i),s=!0)},o(i){_(r.$$.fragment,i),_(l.$$.fragment,i),s=!1},d(i){i&&w(e),D(r),D(l)}}}function Mr(n,e,r){let{lazyFolders:t}=e;return n.$$set=l=>{"lazyFolders"in l&&r(0,t=l.lazyFolders)},[t]}class Or extends N{constructor(e){super(),Q(this,e,Mr,Dr,A,{lazyFolders:0})}}function qr(n){let e,r,t,l;return{c(){e=j("svg"),r=j("path"),t=j("path"),c(r,"d","M21.12 21.1765L3.83997 21.1765L3.83997 19.7647C3.83997 18.985 3.19526 18.3529 2.39997 18.3529C1.60468 18.3529 0.959966 18.985 0.959966 19.7647L0.959966 22.5882C0.959966 22.9781 1.12114 23.331 1.38173 23.5865C1.64232 23.842 2.00232 24 2.39997 24L22.56 24C22.7541 24 22.9393 23.9623 23.1084 23.894C23.6317 23.6826 24 23.1776 24 22.5882L24 19.7647C24 18.985 23.3553 18.3529 22.56 18.3529C21.7647 18.3529 21.12 18.985 21.12 19.7647L21.12 21.1765Z"),c(r,"fill","currentColor"),c(t,"d","M18.884 10.0314C18.6841 9.93335 18.4636 9.88232 18.2401 9.88232C17.9285 9.88232 17.6253 9.9814 17.3761 10.1647L13.92 12.7159C13.92 12.7125 13.92 12.7092 13.92 12.7059L13.92 1.41176C13.92 1.03734 13.7683 0.67825 13.4983 0.413493C13.2282 0.148736 12.862 -2.98024e-06 12.48 -3.01363e-06C12.0981 -3.04702e-06 11.7319 0.148736 11.4618 0.413493C11.1918 0.67825 11.04 1.03734 11.04 1.41176L11.04 12.7059C11.04 12.7325 11.0408 12.7591 11.0423 12.7855L7.55526 10.3764C7.40048 10.2681 7.22535 10.1909 7.03998 10.1493C6.85461 10.1077 6.66267 10.1025 6.47523 10.134C6.2878 10.1655 6.10858 10.233 5.94794 10.3328C5.78729 10.4326 5.64839 10.5626 5.53926 10.7153C5.32063 11.0207 5.23426 11.3986 5.29902 11.7664C5.36378 12.1341 5.57441 12.4617 5.88485 12.6776L11.6449 16.6588C11.8915 16.8355 12.189 16.9307 12.4945 16.9307C12.7999 16.9307 13.0974 16.8355 13.3441 16.6588L19.1041 12.4235C19.2553 12.3123 19.3828 12.1729 19.4791 12.0134C19.5755 11.8538 19.6388 11.6773 19.6656 11.4937C19.6923 11.3102 19.6819 11.1233 19.635 10.9437C19.5881 10.7641 19.5055 10.5953 19.3921 10.447C19.2579 10.2717 19.084 10.1294 18.884 10.0314Z"),c(t,"fill","currentColor"),c(t,"class",l=Ae(n[0]?"animatedArrow":null)+" svelte-1k824dx"),c(e,"width","24"),c(e,"height","24"),c(e,"viewBox","0 0 24 24"),c(e,"fill","none"),c(e,"xmlns","http://www.w3.org/2000/svg")},m(s,i){C(s,e,i),d(e,r),d(e,t)},p(s,[i]){i&1&&l!==(l=Ae(s[0]?"animatedArrow":null)+" svelte-1k824dx")&&c(t,"class",l)},i:M,o:M,d(s){s&&w(e)}}}function Sr(n,e,r){let{animated:t}=e;return n.$$set=l=>{"animated"in l&&r(0,t=l.animated)},[t]}class Ar extends N{constructor(e){super(),Q(this,e,Sr,qr,A,{animated:0})}}function jr(n){let e,r,t,l,s,i,a;const o=n[6].default,u=Ie(o,n,n[5],null);return l=new Ar({props:{animated:n[0]}}),{c(){e=v("main"),u&&u.c(),r=O(),t=v("span"),q(l.$$.fragment),c(t,"class","fm-dropzone svelte-lkheja"),W(t,"active",n[0]),c(e,"class","fm-main svelte-lkheja")},m(f,h){C(f,e,h),u&&u.m(e,null),d(e,r),d(e,t),E(l,t,null),s=!0,i||(a=[ee(rn.call(null,e)),V(e,"dropzoneover",n[1]),V(e,"dropzoneleave",n[2]),V(e,"drop",n[4])],i=!0)},p(f,h){u&&u.p&&(!s||h&32)&&Re(u,o,f,f[5],s?Pe(o,f[5],h,null):Ve(f[5]),null);const g={};h&1&&(g.animated=f[0]),l.$set(g),h&1&&W(t,"active",f[0])},i(f){s||(m(u,f),m(l.$$.fragment,f),s=!0)},o(f){_(u,f),_(l.$$.fragment,f),s=!1},d(f){f&&w(e),u&&u.d(f),D(l),i=!1,G(a)}}}function Qr(n){let e,r;const t=n[6].default,l=Ie(t,n,n[5],null);return{c(){e=v("main"),l&&l.c(),c(e,"class","fm-main svelte-lkheja")},m(s,i){C(s,e,i),l&&l.m(e,null),r=!0},p(s,i){l&&l.p&&(!r||i&32)&&Re(l,t,s,s[5],r?Pe(t,s[5],i,null):Ve(s[5]),null)},i(s){r||(m(l,s),r=!0)},o(s){_(l,s),r=!1},d(s){s&&w(e),l&&l.d(s)}}}function Nr(n){let e,r,t,l;const s=[Qr,jr],i=[];function a(o,u){return o[3].readOnly?0:1}return e=a(n),r=i[e]=s[e](n),{c(){r.c(),t=ue()},m(o,u){i[e].m(o,u),C(o,t,u),l=!0},p(o,[u]){r.p(o,u)},i(o){l||(m(r),l=!0)},o(o){_(r),l=!1},d(o){i[e].d(o),o&&w(t)}}}function Br(n,e,r){let t;J(n,Le,g=>r(7,t=g));let{$$slots:l={},$$scope:s}=e,i=!1;const a=()=>r(0,i=!0),o=()=>r(0,i=!1),u=ve(),f=ne(),h=g=>{Array.from(g.dataTransfer.files).forEach(async y=>{tt.push(y),await nn(f,u,y,t),tt.remove(y)})};return n.$$set=g=>{"$$scope"in g&&r(5,s=g.$$scope)},[i,a,o,f,h,s,l]}class Ir extends N{constructor(e){super(),Q(this,e,Br,Nr,A,{})}}function zt(n,e,r){const t=n.slice();return t[1]=e[r],t}function Lt(n){let e,r,t=n[0],l=[];for(let i=0;i<t.length;i+=1)l[i]=Ft(zt(n,t,i));const s=i=>_(l[i],1,1,()=>{l[i]=null});return{c(){e=v("aside");for(let i=0;i<l.length;i+=1)l[i].c();c(e,"class","fm-upload-progress svelte-3nncjb")},m(i,a){C(i,e,a);for(let o=0;o<l.length;o+=1)l[o].m(e,null);r=!0},p(i,a){if(a&1){t=i[0];let o;for(o=0;o<t.length;o+=1){const u=zt(i,t,o);l[o]?(l[o].p(u,a),m(l[o],1)):(l[o]=Ft(u),l[o].c(),m(l[o],1),l[o].m(e,null))}for(Z(),o=t.length;o<l.length;o+=1)s(o);K()}},i(i){if(!r){for(let a=0;a<t.length;a+=1)m(l[a]);r=!0}},o(i){l=l.filter(Boolean);for(let a=0;a<l.length;a+=1)_(l[a]);r=!1},d(i){i&&w(e),Fe(l,i)}}}function Ft(n){let e,r,t=n[1].name+"",l,s,i,a,o,u;return{c(){e=v("div"),r=v("div"),l=te(t),s=O(),i=v("div"),a=O(),c(i,"class","fm-upload-progress-bar svelte-3nncjb"),c(r,"class","fm-upload-progress-item svelte-3nncjb")},m(f,h){C(f,e,h),d(e,r),d(r,l),d(r,s),d(r,i),d(e,a),u=!0},p(f,h){(!u||h&1)&&t!==(t=f[1].name+"")&&ge(l,t)},i(f){u||(oe(()=>{o||(o=le(e,ie,{x:20},!0)),o.run(1)}),u=!0)},o(f){o||(o=le(e,ie,{x:20},!1)),o.run(0),u=!1},d(f){f&&w(e),f&&o&&o.end()}}}function Pr(n){let e,r,t=n[0].length>0&&Lt(n);return{c(){t&&t.c(),e=ue()},m(l,s){t&&t.m(l,s),C(l,e,s),r=!0},p(l,[s]){l[0].length>0?t?(t.p(l,s),s&1&&m(t,1)):(t=Lt(l),t.c(),m(t,1),t.m(e.parentNode,e)):t&&(Z(),_(t,1,1,()=>{t=null}),K())},i(l){r||(m(t),r=!0)},o(l){_(t),r=!1},d(l){t&&t.d(l),l&&w(e)}}}function Rr(n,e,r){let t;return J(n,tt,l=>r(0,t=l)),[t]}class Vr extends N{constructor(e){super(),Q(this,e,Rr,Pr,A,{})}}function Zr(n){let e,r,t;return{c(){e=j("svg"),r=j("rect"),t=j("path"),c(r,"width","16"),c(r,"height","16"),c(r,"fill","white"),c(t,"fill-rule","evenodd"),c(t,"clip-rule","evenodd"),c(t,"d","M1 0H15C15.6 0 16 0.4 16 1V15C16 15.6 15.6 16 15 16H1C0.4 16 0 15.6 0 15V1C0 0.4 0.4 0 1 0ZM10.1 11.5L11.5 10.1L9.4 8L11.5 5.9L10.1 4.5L8 6.6L5.9 4.5L4.5 5.9L6.6 8L4.5 10.1L5.9 11.5L8 9.4L10.1 11.5Z"),c(t,"fill","currentColor"),c(e,"width","16"),c(e,"height","16"),c(e,"viewBox","0 0 16 16"),c(e,"fill","none"),c(e,"xmlns","http://www.w3.org/2000/svg")},m(l,s){C(l,e,s),d(e,r),d(e,t)},p:M,i:M,o:M,d(l){l&&w(e)}}}class ln extends N{constructor(e){super(),Q(this,e,null,Zr,A,{})}}function Kr(n){let e,r,t,l;return{c(){e=j("svg"),r=j("path"),t=j("path"),l=j("path"),c(r,"d","M7 8H1c-.6 0-1 .4-1 1v6c0 .6.4 1 1 1h6c.6 0 1-.4 1-1V9c0-.6-.4-1-1-1z"),c(r,"fill","currentColor"),c(t,"d","M11 4H2v2h8v8h2V5c0-.6-.4-1-1-1z"),c(t,"fill","currentColor"),c(l,"d","M15 0H6v2h8v8h2V1c0-.6-.4-1-1-1z"),c(l,"fill","currentColor"),c(e,"fill","none"),c(e,"xmlns","http://www.w3.org/2000/svg"),c(e,"width",n[0]),c(e,"height",n[0]),c(e,"viewBox","0 0 16 16")},m(s,i){C(s,e,i),d(e,r),d(e,t),d(e,l)},p(s,[i]){i&1&&c(e,"width",s[0]),i&1&&c(e,"height",s[0])},i:M,o:M,d(s){s&&w(e)}}}function Hr(n,e,r){let{size:t=16}=e;return n.$$set=l=>{"size"in l&&r(0,t=l.size)},[t]}class Ur extends N{constructor(e){super(),Q(this,e,Hr,Kr,A,{size:0})}}function sn(n,e){const r=ve(),t=ne();return{handleClick:()=>{e.dispatchEvent(new CustomEvent("selectfile",{detail:n,bubbles:!0}))},handleCopy:()=>{navigator.clipboard.writeText(n.url),me("Le lien a été copié dans votre presse papier")},handleDelete:()=>{confirm(H("deleteConfirm"))&&Gn(t,r,n)}}}function on(n,e){return n.length<=e?n:n.slice(0,e-11)+"..."+n.slice(-8)}function Gr(n){let e,r,t,l,s;return r=new ln({}),{c(){e=v("button"),q(r.$$.fragment),c(e,"class","svelte-1ntuvox")},m(i,a){C(i,e,a),E(r,e,null),t=!0,l||(s=[ee(Ke.call(null,e,H("delete"))),V(e,"click",lt(ae(function(){se(n[3].handleDelete)&&n[3].handleDelete.apply(this,arguments)})))],l=!0)},p(i,a){n=i},i(i){t||(m(r.$$.fragment,i),t=!0)},o(i){_(r.$$.fragment,i),t=!1},d(i){i&&w(e),D(r),l=!1,G(s)}}}function Jr(n){let e,r,t,l,s,i,a,o,u,f,h,g=(n[0].size?n[5].format(n[0].size/1e3):null)+"",y,z,b,p,$,I,k,L,F;$=new Ur({});let R=!n[4].readOnly&&Gr(n);return{c(){e=v("tr"),r=v("td"),t=O(),l=v("td"),s=v("img"),a=O(),o=v("td"),u=te(n[2]),f=O(),h=v("td"),y=te(g),z=O(),b=v("td"),p=v("button"),q($.$$.fragment),I=O(),R&&R.c(),c(r,"class","svelte-1ntuvox"),Se(s.src,i=n[0].thumbnail)||c(s,"src",i),c(s,"alt",""),c(s,"class","svelte-1ntuvox"),c(l,"class","svelte-1ntuvox"),c(o,"class","filename svelte-1ntuvox"),c(h,"class","svelte-1ntuvox"),c(p,"class","svelte-1ntuvox"),c(b,"class","actions svelte-1ntuvox"),c(e,"class","svelte-1ntuvox")},m(P,B){C(P,e,B),d(e,r),d(e,t),d(e,l),d(l,s),d(e,a),d(e,o),d(o,u),d(e,f),d(e,h),d(h,y),d(e,z),d(e,b),d(b,p),E($,p,null),d(b,I),R&&R.m(b,null),n[6](e),k=!0,L||(F=[ee(Ke.call(null,p,H("copy"))),V(p,"click",lt(ae(function(){se(n[3].handleCopy)&&n[3].handleCopy.apply(this,arguments)}))),V(e,"click",function(){se(n[3].handleClick)&&n[3].handleClick.apply(this,arguments)})],L=!0)},p(P,[B]){n=P,(!k||B&1&&!Se(s.src,i=n[0].thumbnail))&&c(s,"src",i),(!k||B&4)&&ge(u,n[2]),(!k||B&1)&&g!==(g=(n[0].size?n[5].format(n[0].size/1e3):null)+"")&&ge(y,g),n[4].readOnly||R.p(n,B)},i(P){k||(m($.$$.fragment,P),m(R),k=!0)},o(P){_($.$$.fragment,P),_(R),k=!1},d(P){P&&w(e),D($),R&&R.d(),n[6](null),L=!1,G(F)}}}function Wr(n,e,r){let t,l,s;const i=ne(),a=new Intl.NumberFormat(void 0,{style:"unit",unit:"kilobyte",unitDisplay:"short",maximumSignificantDigits:3});let{file:o}=e;function u(f){Ne[f?"unshift":"push"](()=>{s=f,r(1,s)})}return n.$$set=f=>{"file"in f&&r(0,o=f.file)},n.$$.update=()=>{n.$$.dirty&3&&r(3,t=sn(o,s)),n.$$.dirty&1&&r(2,l=on(o.name,35))},[o,s,l,t,i,a,u]}class Yr extends N{constructor(e){super(),Q(this,e,Wr,Jr,A,{file:0})}}function Et(n,e,r){const t=n.slice();return t[1]=e[r],t}function Dt(n){let e,r;return e=new Yr({props:{file:n[1]}}),{c(){q(e.$$.fragment)},m(t,l){E(e,t,l),r=!0},p(t,l){const s={};l&1&&(s.file=t[1]),e.$set(s)},i(t){r||(m(e.$$.fragment,t),r=!0)},o(t){_(e.$$.fragment,t),r=!1},d(t){D(e,t)}}}function Xr(n){let e,r,t,l,s,i,a,o,u,f,h,g,y,z,b,p=n[0],$=[];for(let k=0;k<p.length;k+=1)$[k]=Dt(Et(n,p,k));const I=k=>_($[k],1,1,()=>{$[k]=null});return{c(){e=v("table"),r=v("thead"),t=v("tr"),l=v("th"),s=O(),i=v("th"),a=O(),o=v("th"),o.textContent=`${H("filename")}`,u=O(),f=v("th"),f.textContent=`${H("size")}`,h=O(),g=v("th"),y=O(),z=v("tbody");for(let k=0;k<$.length;k+=1)$[k].c();c(e,"class","svelte-88gfvn")},m(k,L){C(k,e,L),d(e,r),d(r,t),d(t,l),d(t,s),d(t,i),d(t,a),d(t,o),d(t,u),d(t,f),d(t,h),d(t,g),d(e,y),d(e,z);for(let F=0;F<$.length;F+=1)$[F].m(z,null);b=!0},p(k,[L]){if(L&1){p=k[0];let F;for(F=0;F<p.length;F+=1){const R=Et(k,p,F);$[F]?($[F].p(R,L),m($[F],1)):($[F]=Dt(R),$[F].c(),m($[F],1),$[F].m(z,null))}for(Z(),F=p.length;F<$.length;F+=1)I(F);K()}},i(k){if(!b){for(let L=0;L<p.length;L+=1)m($[L]);b=!0}},o(k){$=$.filter(Boolean);for(let L=0;L<$.length;L+=1)_($[L]);b=!1},d(k){k&&w(e),Fe($,k)}}}function Tr(n,e,r){let{files:t}=e;return n.$$set=l=>{"files"in l&&r(0,t=l.files)},[t]}class xr extends N{constructor(e){super(),Q(this,e,Tr,Xr,A,{files:0})}}function el(n){let e,r,t,l,s;return r=new ln({}),{c(){e=v("button"),q(r.$$.fragment),c(e,"class","fm-delete svelte-c91skb")},m(i,a){C(i,e,a),E(r,e,null),t=!0,l||(s=[ee(Ke.call(null,e,H("delete"))),V(e,"click",lt(ae(function(){se(n[2].handleDelete)&&n[2].handleDelete.apply(this,arguments)})))],l=!0)},p(i,a){n=i},i(i){t||(m(r.$$.fragment,i),t=!0)},o(i){_(r.$$.fragment,i),t=!1},d(i){i&&w(e),D(r),l=!1,G(s)}}}function tl(n){let e,r,t,l,s,i,a,o,u,f,h,g=!n[4].readOnly&&el(n);return{c(){e=v("div"),r=v("div"),t=v("img"),s=O(),g&&g.c(),i=O(),a=v("div"),o=te(n[3]),Se(t.src,l=n[0].thumbnail)||c(t,"src",l),c(t,"alt",""),c(t,"class","svelte-c91skb"),c(r,"class","fm-thumbnail svelte-c91skb"),c(a,"class","fm-filename svelte-c91skb"),c(e,"class","fm-file svelte-c91skb")},m(y,z){C(y,e,z),d(e,r),d(r,t),d(r,s),g&&g.m(r,null),d(e,i),d(e,a),d(a,o),n[5](e),u=!0,f||(h=V(e,"click",function(){se(n[2].handleClick)&&n[2].handleClick.apply(this,arguments)}),f=!0)},p(y,[z]){n=y,(!u||z&1&&!Se(t.src,l=n[0].thumbnail))&&c(t,"src",l),n[4].readOnly||g.p(n,z),(!u||z&8)&&ge(o,n[3])},i(y){u||(m(g),u=!0)},o(y){_(g),u=!1},d(y){y&&w(e),g&&g.d(),n[5](null),f=!1,h()}}}function nl(n,e,r){let t,l,s;const i=ne();let{file:a}=e;function o(u){Ne[u?"unshift":"push"](()=>{s=u,r(1,s)})}return n.$$set=u=>{"file"in u&&r(0,a=u.file)},n.$$.update=()=>{n.$$.dirty&1&&r(3,t=on(a.name,30)),n.$$.dirty&3&&r(2,l=sn(a,s))},[a,s,l,t,i,o]}class rl extends N{constructor(e){super(),Q(this,e,nl,tl,A,{file:0})}}function Mt(n,e,r){const t=n.slice();return t[1]=e[r],t}function Ot(n){let e,r;return e=new rl({props:{file:n[1]}}),{c(){q(e.$$.fragment)},m(t,l){E(e,t,l),r=!0},p(t,l){const s={};l&1&&(s.file=t[1]),e.$set(s)},i(t){r||(m(e.$$.fragment,t),r=!0)},o(t){_(e.$$.fragment,t),r=!1},d(t){D(e,t)}}}function ll(n){let e,r,t=n[0],l=[];for(let i=0;i<t.length;i+=1)l[i]=Ot(Mt(n,t,i));const s=i=>_(l[i],1,1,()=>{l[i]=null});return{c(){e=v("div");for(let i=0;i<l.length;i+=1)l[i].c();c(e,"class","grid svelte-trks37")},m(i,a){C(i,e,a);for(let o=0;o<l.length;o+=1)l[o].m(e,null);r=!0},p(i,[a]){if(a&1){t=i[0];let o;for(o=0;o<t.length;o+=1){const u=Mt(i,t,o);l[o]?(l[o].p(u,a),m(l[o],1)):(l[o]=Ot(u),l[o].c(),m(l[o],1),l[o].m(e,null))}for(Z(),o=t.length;o<l.length;o+=1)s(o);K()}},i(i){if(!r){for(let a=0;a<t.length;a+=1)m(l[a]);r=!0}},o(i){l=l.filter(Boolean);for(let a=0;a<l.length;a+=1)_(l[a]);r=!1},d(i){i&&w(e),Fe(l,i)}}}function il(n,e,r){let{files:t}=e;return n.$$set=l=>{"files"in l&&r(0,t=l.files)},[t]}class sl extends N{constructor(e){super(),Q(this,e,il,ll,A,{files:0})}}function ol(n){let e,r,t,l,s,i,a=n[3]&&!n[5].readOnly&&qt(n);return{c(){e=v("div"),r=v("p"),r.textContent=`${H("emptyTitle")}`,t=O(),l=v("p"),l.textContent=`${H("emptyDescription")}`,s=O(),a&&a.c(),c(r,"class","big svelte-mbr02"),c(l,"class","svelte-mbr02"),c(e,"class","empty svelte-mbr02")},m(o,u){C(o,e,u),d(e,r),d(e,t),d(e,l),d(e,s),a&&a.m(e,null),i=!0},p(o,u){o[3]&&!o[5].readOnly?a?(a.p(o,u),u&8&&m(a,1)):(a=qt(o),a.c(),m(a,1),a.m(e,null)):a&&(Z(),_(a,1,1,()=>{a=null}),K())},i(o){i||(m(a),i=!0)},o(o){_(a),i=!1},d(o){o&&w(e),a&&a.d()}}}function al(n){let e,r,t;return r=new Ze({}),{c(){e=v("div"),q(r.$$.fragment),c(e,"class","empty svelte-mbr02")},m(l,s){C(l,e,s),E(r,e,null),t=!0},p:M,i(l){t||(m(r.$$.fragment,l),t=!0)},o(l){_(r.$$.fragment,l),t=!1},d(l){l&&w(e),D(r)}}}function ul(n){let e,r,t,l;const s=[fl,cl],i=[];function a(o,u){return o[0]==="rows"?0:1}return e=a(n),r=i[e]=s[e](n),{c(){r.c(),t=ue()},m(o,u){i[e].m(o,u),C(o,t,u),l=!0},p(o,u){let f=e;e=a(o),e===f?i[e].p(o,u):(Z(),_(i[f],1,1,()=>{i[f]=null}),K(),r=i[e],r?r.p(o,u):(r=i[e]=s[e](o),r.c()),m(r,1),r.m(t.parentNode,t))},i(o){l||(m(r),l=!0)},o(o){_(r),l=!1},d(o){i[e].d(o),o&&w(t)}}}function qt(n){let e,r,t=H("deleteFolder")+"",l,s,i,a,o,u=n[4].isLoading&&St();return{c(){e=v("button"),u&&u.c(),r=O(),l=te(t),c(e,"class","delete-folder svelte-mbr02"),e.disabled=s=n[4].isLoading},m(f,h){C(f,e,h),u&&u.m(e,null),d(e,r),d(e,l),i=!0,a||(o=V(e,"click",ae(n[7])),a=!0)},p(f,h){f[4].isLoading?u?h&16&&m(u,1):(u=St(),u.c(),m(u,1),u.m(e,r)):u&&(Z(),_(u,1,1,()=>{u=null}),K()),(!i||h&16&&s!==(s=f[4].isLoading))&&(e.disabled=s)},i(f){i||(m(u),i=!0)},o(f){_(u),i=!1},d(f){f&&w(e),u&&u.d(),a=!1,o()}}}function St(n){let e,r;return e=new Ze({props:{size:12}}),{c(){q(e.$$.fragment)},m(t,l){E(e,t,l),r=!0},i(t){r||(m(e.$$.fragment,t),r=!0)},o(t){_(e.$$.fragment,t),r=!1},d(t){D(e,t)}}}function cl(n){let e,r;return e=new sl({props:{files:n[2]}}),{c(){q(e.$$.fragment)},m(t,l){E(e,t,l),r=!0},p(t,l){const s={};l&4&&(s.files=t[2]),e.$set(s)},i(t){r||(m(e.$$.fragment,t),r=!0)},o(t){_(e.$$.fragment,t),r=!1},d(t){D(e,t)}}}function fl(n){let e,r;return e=new xr({props:{files:n[2]}}),{c(){q(e.$$.fragment)},m(t,l){E(e,t,l),r=!0},p(t,l){const s={};l&4&&(s.files=t[2]),e.$set(s)},i(t){r||(m(e.$$.fragment,t),r=!0)},o(t){_(e.$$.fragment,t),r=!1},d(t){D(e,t)}}}function dl(n){let e,r,t,l;const s=[ul,al,ol],i=[];function a(o,u){return o[2].length>0?0:o[1].isLoading?1:2}return e=a(n),r=i[e]=s[e](n),{c(){r.c(),t=ue()},m(o,u){i[e].m(o,u),C(o,t,u),l=!0},p(o,[u]){let f=e;e=a(o),e===f?i[e].p(o,u):(Z(),_(i[f],1,1,()=>{i[f]=null}),K(),r=i[e],r?r.p(o,u):(r=i[e]=s[e](o),r.c()),m(r,1),r.m(t.parentNode,t))},i(o){l||(m(r),l=!0)},o(o){_(r),l=!1},d(o){i[e].d(o),o&&w(t)}}}function hl(n,e,r){let t,l,s,i,a;J(n,qe,p=>r(12,i=p));let{layout:o}=e,{folder:u}=e;const f=ne(),h=Wn();J(n,h,p=>r(4,a=p));const g=()=>{u&&a.mutate(u)},y=et(ot(u==null?void 0:u.id),()=>ne().getFiles(u));J(n,y,p=>r(1,l=p));let z=[];const b=et(ze(u==null?void 0:u.id),()=>[],{enabled:!1});return J(n,b,p=>r(11,s=p)),n.$$set=p=>{"layout"in p&&r(0,o=p.layout),"folder"in p&&r(10,u=p.folder)},n.$$.update=()=>{var p,$;n.$$.dirty&4098&&r(2,z=l.isSuccess?l.data.filter(I=>i?I.name.includes(i):!0):[]),n.$$.dirty&3074&&r(3,t=(u==null?void 0:u.id)&&((u==null?void 0:u.children)&&u.children.length===0||s.isSuccess&&((p=s==null?void 0:s.data)==null?void 0:p.length)===0)&&l.isSuccess&&(($=l==null?void 0:l.data)==null?void 0:$.length)===0)},[o,l,z,t,a,f,h,g,y,b,u,s,i]}class ml extends N{constructor(e){super(),Q(this,e,hl,dl,A,{layout:0,folder:10})}}function pl(n){let e,r,t;return{c(){e=j("svg"),r=j("path"),t=j("path"),c(r,"stroke","currentColor"),c(r,"stroke-width","2"),c(r,"d","M12 22a10 10 0 1 0 0-20 10 10 0 0 0 0 20Z"),c(t,"stroke","currentColor"),c(t,"stroke-linecap","round"),c(t,"stroke-width","2"),c(t,"d","M12 16.5v.5m0-10v6-6Z"),c(e,"xmlns","http://www.w3.org/2000/svg"),c(e,"fill","none"),c(e,"viewBox","0 0 24 24"),c(e,"width",n[0]),c(e,"height",n[0])},m(l,s){C(l,e,s),d(e,r),d(e,t)},p(l,[s]){s&1&&c(e,"width",l[0]),s&1&&c(e,"height",l[0])},i:M,o:M,d(l){l&&w(e)}}}function gl(n,e,r){let{size:t=24}=e;return n.$$set=l=>{"size"in l&&r(0,t=l.size)},[t]}class _l extends N{constructor(e){super(),Q(this,e,gl,pl,A,{size:0})}}function vl(n){let e,r,t;return{c(){e=j("svg"),r=j("path"),t=j("path"),c(r,"stroke","currentColor"),c(r,"stroke-linecap","round"),c(r,"stroke-linejoin","round"),c(r,"stroke-width","2"),c(r,"d","m8 12.5 3 3 5-6"),c(t,"stroke","currentColor"),c(t,"stroke-width","2"),c(t,"d","M12 22a10 10 0 1 0 0-20 10 10 0 0 0 0 20Z"),c(e,"xmlns","http://www.w3.org/2000/svg"),c(e,"fill","none"),c(e,"viewBox","0 0 24 24"),c(e,"width",n[0]),c(e,"height",n[0])},m(l,s){C(l,e,s),d(e,r),d(e,t)},p(l,[s]){s&1&&c(e,"width",l[0]),s&1&&c(e,"height",l[0])},i:M,o:M,d(l){l&&w(e)}}}function bl(n,e,r){let{size:t=24}=e;return n.$$set=l=>{"size"in l&&r(0,t=l.size)},[t]}class yl extends N{constructor(e){super(),Q(this,e,bl,vl,A,{size:0})}}function $l(n){let e,r,t,l;return e=new yl({}),{c(){q(e.$$.fragment),r=O(),t=v("div"),c(t,"class","fm-progress svelte-rcwbts")},m(s,i){E(e,s,i),C(s,r,i),C(s,t,i),l=!0},i(s){l||(m(e.$$.fragment,s),l=!0)},o(s){_(e.$$.fragment,s),l=!1},d(s){D(e,s),s&&w(r),s&&w(t)}}}function wl(n){let e,r;return e=new _l({}),{c(){q(e.$$.fragment)},m(t,l){E(e,t,l),r=!0},i(t){r||(m(e.$$.fragment,t),r=!0)},o(t){_(e.$$.fragment,t),r=!1},d(t){D(e,t)}}}function kl(n){let e,r,t,l,s=n[0].message+"",i,a,o,u,f,h;const g=[wl,$l],y=[];function z(b,p){return b[0].type==="danger"?0:b[0].type==="success"?1:-1}return~(r=z(n))&&(t=y[r]=g[r](n)),{c(){e=v("div"),t&&t.c(),l=O(),i=te(s),a=O(),o=v("button"),o.textContent="×",c(o,"class","fm-close svelte-rcwbts"),c(e,"class","fm-alert svelte-rcwbts"),W(e,"fm-danger",n[0].type==="danger"),W(e,"fm-success",n[0].type==="success")},m(b,p){C(b,e,p),~r&&y[r].m(e,null),d(e,l),d(e,i),d(e,a),d(e,o),u=!0,f||(h=V(o,"click",ae(n[1])),f=!0)},p(b,[p]){let $=r;r=z(b),r!==$&&(t&&(Z(),_(y[$],1,1,()=>{y[$]=null}),K()),~r?(t=y[r],t||(t=y[r]=g[r](b),t.c()),m(t,1),t.m(e,l)):t=null),(!u||p&1)&&s!==(s=b[0].message+"")&&ge(i,s),p&1&&W(e,"fm-danger",b[0].type==="danger"),p&1&&W(e,"fm-success",b[0].type==="success")},i(b){u||(m(t),u=!0)},o(b){_(t),u=!1},d(b){b&&w(e),~r&&y[r].d(),f=!1,h()}}}function Cl(n,e,r){let{message:t}=e;const l=()=>{Un(t.id)};return n.$$set=s=>{"message"in s&&r(0,t=s.message)},[t,l]}class zl extends N{constructor(e){super(),Q(this,e,Cl,kl,A,{message:0})}}function At(n,e,r){const t=n.slice();return t[1]=e[r],t}function jt(n){let e,r,t,l,s;return r=new zl({props:{message:n[1]}}),{c(){e=v("div"),q(r.$$.fragment),t=O()},m(i,a){C(i,e,a),E(r,e,null),d(e,t),s=!0},p(i,a){const o={};a&1&&(o.message=i[1]),r.$set(o)},i(i){s||(m(r.$$.fragment,i),oe(()=>{l||(l=le(e,ie,{x:20},!0)),l.run(1)}),s=!0)},o(i){_(r.$$.fragment,i),l||(l=le(e,ie,{x:20},!1)),l.run(0),s=!1},d(i){i&&w(e),D(r),i&&l&&l.end()}}}function Ll(n){let e,r,t=n[0],l=[];for(let i=0;i<t.length;i+=1)l[i]=jt(At(n,t,i));const s=i=>_(l[i],1,1,()=>{l[i]=null});return{c(){e=v("div");for(let i=0;i<l.length;i+=1)l[i].c();c(e,"class","fm-wrapper svelte-1ja1s61")},m(i,a){C(i,e,a);for(let o=0;o<l.length;o+=1)l[o].m(e,null);r=!0},p(i,[a]){if(a&1){t=i[0];let o;for(o=0;o<t.length;o+=1){const u=At(i,t,o);l[o]?(l[o].p(u,a),m(l[o],1)):(l[o]=jt(u),l[o].c(),m(l[o],1),l[o].m(e,null))}for(Z(),o=t.length;o<l.length;o+=1)s(o);K()}},i(i){if(!r){for(let a=0;a<t.length;a+=1)m(l[a]);r=!0}},o(i){l=l.filter(Boolean);for(let a=0;a<l.length;a+=1)_(l[a]);r=!1},d(i){i&&w(e),Fe(l,i)}}}function Fl(n,e,r){let t;return J(n,Be,l=>r(0,t=l)),[t]}class El extends N{constructor(e){super(),Q(this,e,Fl,Ll,A,{})}}function Qt(n){let e,r,t,l,s,i,a,o,u,f,h,g,y,z,b;return l=new Or({props:{lazyFolders:n[2]}}),i=new Ir({props:{$$slots:{default:[Dl]},$$scope:{ctx:n}}}),o=new El({}),f=new Vr({}),{c(){e=v("div"),r=v("div"),t=v("div"),q(l.$$.fragment),s=O(),q(i.$$.fragment),a=O(),q(o.$$.fragment),u=O(),q(f.$$.fragment),c(t,"class","fm-modal svelte-5hhtx0"),c(r,"class","fm-overlay svelte-5hhtx0"),c(e,"class","fm-root svelte-5hhtx0")},m(p,$){C(p,e,$),d(e,r),d(r,t),E(l,t,null),d(t,s),E(i,t,null),d(t,a),E(o,t,null),d(t,u),E(f,t,null),y=!0,z||(b=ee(Yt.call(null,t,"close")),z=!0)},p(p,$){const I={};$&4&&(I.lazyFolders=p[2]),l.$set(I);const k={};$&74&&(k.$$scope={dirty:$,ctx:p}),i.$set(k)},i(p){y||(m(l.$$.fragment,p),m(i.$$.fragment,p),m(o.$$.fragment,p),m(f.$$.fragment,p),oe(()=>{h||(h=le(t,ie,{y:-30,duration:500},!0)),h.run(1)}),oe(()=>{g||(g=le(r,ie,{duration:300},!0)),g.run(1)}),y=!0)},o(p){_(l.$$.fragment,p),_(i.$$.fragment,p),_(o.$$.fragment,p),_(f.$$.fragment,p),h||(h=le(t,ie,{y:-30,duration:500},!1)),h.run(0),g||(g=le(r,ie,{duration:300},!1)),g.run(0),y=!1},d(p){p&&w(e),D(l),D(i),D(o),D(f),p&&h&&h.end(),p&&g&&g.end(),z=!1,b()}}}function Nt(n){let e,r;return e=new ml({props:{folder:n[3],layout:n[1]}}),{c(){q(e.$$.fragment)},m(t,l){E(e,t,l),r=!0},p(t,l){const s={};l&8&&(s.folder=t[3]),l&2&&(s.layout=t[1]),e.$set(s)},i(t){r||(m(e.$$.fragment,t),r=!0)},o(t){_(e.$$.fragment,t),r=!1},d(t){D(e,t)}}}function Dl(n){var e;let r=(e=n[3])==null?void 0:e.id,t,l,s=Nt(n);return{c(){s.c(),t=ue()},m(i,a){s.m(i,a),C(i,t,a),l=!0},p(i,a){var o;a&8&&A(r,r=(o=i[3])==null?void 0:o.id)?(Z(),_(s,1,1,M),K(),s=Nt(i),s.c(),m(s),s.m(t.parentNode,t)):s.p(i,a)},i(i){l||(m(s),l=!0)},o(i){_(s),l=!1},d(i){i&&w(t),s.d(i)}}}function Ml(n){let e,r,t=!n[0]&&Qt(n);return{c(){t&&t.c(),e=ue()},m(l,s){t&&t.m(l,s),C(l,e,s),r=!0},p(l,s){l[0]?t&&(Z(),_(t,1,1,()=>{t=null}),K()):t?(t.p(l,s),s&1&&m(t,1)):(t=Qt(l),t.c(),m(t,1),t.m(e.parentNode,e))},i(l){r||(m(t),r=!0)},o(l){_(t),r=!1},d(l){t&&t.d(l),l&&w(e)}}}function Ol(n){let e,r;return e=new In({props:{client:n[4],$$slots:{default:[Ml]},$$scope:{ctx:n}}}),{c(){q(e.$$.fragment)},m(t,l){E(e,t,l),r=!0},p(t,[l]){const s={};l&79&&(s.$$scope={dirty:l,ctx:t}),e.$set(s)},i(t){r||(m(e.$$.fragment,t),r=!0)},o(t){_(e.$$.fragment,t),r=!1},d(t){D(e,t)}}}function ql(n,e,r){let t;J(n,Le,u=>r(3,t=u));let{hidden:l}=e,{layout:s}=e,{lazyFolders:i}=e,{options:a}=e;Ut("options",a);const o=new Qn;return n.$$set=u=>{"hidden"in u&&r(0,l=u.hidden),"layout"in u&&r(1,s=u.layout),"lazyFolders"in u&&r(2,i=u.lazyFolders),"options"in u&&r(5,a=u.options)},[l,s,i,t,o,a]}class Sl extends N{constructor(e){super(),Q(this,e,ql,Ol,A,{hidden:0,layout:1,lazyFolders:2,options:5})}}function Al(n,e){const r=e||new URLSearchParams;return Object.keys(n).filter(t=>n[t]!==void 0).forEach(t=>r.set(t,n[t])),r}function fe(n,e,r){const t=T({},r);let l=new URL((n.startsWith("/")?window.location.origin:"")+n);return l.pathname=(l.pathname==="/"?"":l.pathname)+e,t.credentials="include",t.headers=T({},t.headers),t.headers.Accept="application/json",t.json&&(t.body=JSON.stringify(t.json),t.headers["Content-Type"]="application/json"),t.query&&Al(t.query,l.searchParams),t.params&&Object.keys(t.params).forEach(s=>l.pathname=l.pathname.replace(`%7B${s}%7D`,t.params[s])),fetch(l.toString(),t).then(s=>{if(s.status===he.NoContent)return null;if(s.status>=he.OK&&s.status<he.MultipleChoices)return s.json();throw s.json().then(i=>{i!=null&&i.message?me(i.message,"danger"):me(H("serverError"),"danger")}).catch(()=>me(H("serverError"),"danger")),s})}const jl={endpoint:"",readOnly:!1,httpHeaders:{},getFolders(n){var e;return fe(this.endpoint,"/folders",{query:{parent:(e=n==null?void 0:n.id)==null?void 0:e.toString()},headers:this.httpHeaders})},createFolder(n){return fe(this.endpoint,"/folders",{method:"post",headers:this.httpHeaders,json:n})},deleteFolder(n){return fe(this.endpoint,"/folders/{id}",{method:"delete",headers:this.httpHeaders,params:{id:n.id.toString()}})},getFiles(n){return fe(this.endpoint,"/files",{headers:this.httpHeaders,query:{folder:n!=null&&n.id?n.id.toString():void 0}})},uploadFile(n,e){const r=new FormData;return r.set("file",n),e!=null&&e.id&&r.set("folder",e.id.toString()),fe(this.endpoint,"/files",{method:"post",headers:this.httpHeaders,body:r})},deleteFile(n){return fe(this.endpoint,"/files/{id}",{method:"delete",headers:this.httpHeaders,params:{id:n.id.toString()}})}},nt=class{constructor(n,e={}){Y(this,"fm",null),Y(this,"options"),this.element=n,this.options=T(T({},jl),e)}static get observedAttributes(){return["hidden","endpoint"]}connectedCallback(){this.element.style.setProperty("display","block");const n=this.element.getAttribute("endpoint");if(n&&(this.options.endpoint=n),this.options.readOnly=this.element.hasAttribute("readonly"),!this.options.endpoint&&!this.options.getFiles)throw new Error("You must define an endpoint for this custom element");Hn(document.documentElement.getAttribute("lang")||"en"),this.fm=new Sl({target:this.element,props:{hidden:this.element.hidden,layout:this.element.getAttribute("layout")||"grid",lazyFolders:this.element.hasAttribute("lazy-folders"),options:this.options}})}attributeChangedCallback(n,e,r){n==="hidden"&&this.fm&&this.fm.$set({hidden:r!==null}),n==="endpoint"&&(this.options.endpoint=r)}disconnectedCallback(){var n;(n=this==null?void 0:this.fm)==null||n.$destroy()}static register(n="file-manager",e){if(!this.registered.has(n)){class r extends HTMLElement{constructor(){super(),Y(this,"decorated"),this.decorated=new nt(this,e)}static get observedAttributes(){return nt.observedAttributes}connectedCallback(){return this.decorated.connectedCallback()}attributeChangedCallback(l,s,i){return this.decorated.attributeChangedCallback(l,s,i)}}customElements.define(n,r),this.registered.set(n,!0)}}};let an=nt;Y(an,"registered",new Map);class Ql extends HTMLElement{connectedCallback(){this.filemanager=this.querySelector("file-manager"),this.imageManagerButton=this.querySelector("button#image-manager"),this.fileInput=this.querySelector('input[name$="[filename]"]'),this.filemanager&&this.imageManagerButton&&this.fileInput&&(an.register(),this.imageManagerButton.addEventListener("click",()=>{this.filemanager.removeAttribute("hidden")}),this.querySelector("button#remove").addEventListener("click",()=>{this.changeValue("")}),this.filemanager.addEventListener("close",()=>{this.filemanager.setAttribute("hidden",!0)}),this.filemanager.addEventListener("selectfile",e=>{console.log(e.detail),this.changeValue(e.detail.url),this.changePreview(e.detail.thumbnail),this.filemanager.setAttribute("hidden",!0)}),this.changeValue(this.fileInput.value),this.changePreview(this.fileInput.value?"/files".this.fileInput.value:null))}changeValue(e){this.fileInput.value=e}changePreview(e){e?this.querySelector(".image--preview").innerHTML=`<a href="${e}" class="editor__image--preview-image" style="background-image: url(${e});background-size: contain"><span class="sr-only">Preview the image</span></a>`:this.querySelector(".image--preview").innerHTML=""}disconnectedCallback(){}}window.customElements.define("image-manager",Ql);
